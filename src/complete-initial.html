<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Overview</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100%;
            display: flex;
        }

        html {
            height: 100%;
        }

        .sidebar {
            width: 250px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            padding: 24px 0;
            position: fixed;
            height: 100%;
            left: 0;
            top: 0;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 0 24px 24px 24px;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 24px;
        }

        .sidebar-logo {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sidebar-nav {
            padding: 0 12px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            margin-bottom: 4px;
            border-radius: 8px;
            color: #4a5568;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
        }

        .nav-item:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            transform: translateX(4px);
        }

        .nav-item.active {
            background: #667eea;
            color: white;
        }

        .nav-item.active:hover {
            background: #5a67d8;
            transform: translateX(0);
        }

        .nav-icon {
            margin-right: 12px;
            font-size: 18px;
            width: 20px;
            text-align: center;
        }

        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: rgba(255, 255, 255, 0.95);
            border: none;
            border-radius: 8px;
            padding: 8px;
            cursor: pointer;
            font-size: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .top-nav {
            position: fixed;
            top: 0;
            left: 250px;
            right: 0;
            height: 70px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            z-index: 999;
            transition: left 0.3s ease;
        }

        .search-container {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px 12px 48px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 14px;
            background: white;
            transition: all 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #718096;
            font-size: 16px;
        }

        .top-nav-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .theme-toggle {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .theme-toggle:hover {
            background: #edf2f7;
            border-color: #cbd5e0;
        }

        .logout-btn {
            background: #f56565;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logout-btn:hover {
            background: #e53e3e;
            transform: translateY(-1px);
        }

        .dashboard-container {
            flex: 1;
            margin-left: 250px;
            margin-top: 70px;
            padding: 20px;
            min-height: calc(100% - 70px);
            transition: margin-left 0.3s ease;
        }

        /* Dark theme styles */
        body.dark-theme {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
        }

        .dark-theme .sidebar,
        .dark-theme .top-nav,
        .dark-theme .header,
        .dark-theme .kpi-card,
        .dark-theme .chart-container,
        .dark-theme .orders-section,
        .dark-theme .notifications {
            background: rgba(45, 55, 72, 0.95);
            color: #f7fafc;
        }

        .dark-theme .sidebar-logo,
        .dark-theme .header h1,
        .dark-theme .kpi-value,
        .dark-theme .chart-title,
        .dark-theme .section-title {
            color: #f7fafc;
        }

        .dark-theme .nav-item {
            color: #cbd5e0;
        }

        .dark-theme .nav-item:hover {
            background: rgba(102, 126, 234, 0.2);
            color: #e2e8f0;
        }

        .dark-theme .search-input {
            background: #2d3748;
            border-color: #4a5568;
            color: #f7fafc;
        }

        .dark-theme .search-input:focus {
            border-color: #667eea;
        }

        .dark-theme .theme-toggle {
            background: #2d3748;
            border-color: #4a5568;
            color: #f7fafc;
        }

        .dark-theme .theme-toggle:hover {
            background: #4a5568;
        }

        .dark-theme .orders-table th {
            background: #2d3748;
            color: #cbd5e0;
        }

        .dark-theme .orders-table td {
            color: #f7fafc;
        }

        .dark-theme .orders-table th,
        .dark-theme .orders-table td {
            border-bottom-color: #4a5568;
        }

        .dark-theme .notification-text {
            color: #f7fafc;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            margin: 0 0 16px 0;
            color: #2d3748;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .date-filter {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .date-filter select {
            padding: 8px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .date-filter select:hover {
            border-color: #667eea;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .kpi-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            border-left: 4px solid;
        }

        .kpi-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .kpi-card.sales { border-left-color: #48bb78; }
        .kpi-card.orders { border-left-color: #4299e1; }
        .kpi-card.revenue { border-left-color: #ed8936; }
        .kpi-card.users { border-left-color: #9f7aea; }

        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .kpi-title {
            font-size: 14px;
            color: #718096;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .kpi-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .kpi-change {
            font-size: 14px;
            font-weight: 600;
        }

        .kpi-change.positive { color: #48bb78; }
        .kpi-change.negative { color: #f56565; }

        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
        }

        .chart-canvas {
            max-height: 300px;
        }

        .orders-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 24px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #2d3748;
        }

        .view-all-btn {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .view-all-btn:hover {
            background: #5a67d8;
        }

        .orders-table {
            width: 100%;
            border-collapse: collapse;
            overflow-x: auto;
        }

        .orders-table th,
        .orders-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .orders-table th {
            background: #f7fafc;
            font-weight: 600;
            color: #4a5568;
            font-size: 14px;
        }

        .orders-table td {
            color: #2d3748;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-completed { background: #c6f6d5; color: #22543d; }
        .status-pending { background: #fef5e7; color: #c05621; }
        .status-processing { background: #bee3f8; color: #2a69ac; }
        .status-shipped { background: #e6fffa; color: #234e52; }
        .status-delivered { background: #c6f6d5; color: #22543d; }
        .status-cancelled { background: #fed7d7; color: #c53030; }

        .notifications {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .notification-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 14px;
        }

        .notification-content {
            flex: 1;
        }

        .notification-text {
            font-size: 14px;
            color: #2d3748;
            margin-bottom: 4px;
        }

        .notification-time {
            font-size: 12px;
            color: #718096;
        }

        /* Product Management Styles */
        .product-actions {
            display: flex;
            gap: 12px;
        }

        .add-product-btn {
            background: #48bb78;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .add-product-btn:hover {
            background: #38a169;
            transform: translateY(-1px);
        }

        .filters-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .filter-group {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 2fr;
            gap: 16px;
            align-items: center;
        }

        .filter-input, .filter-select, .price-input {
            padding: 10px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            transition: all 0.2s;
        }

        .filter-input:focus, .filter-select:focus, .price-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .price-range {
            display: flex;
            gap: 8px;
        }

        .products-table-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        .products-table {
            width: 100%;
            border-collapse: collapse;
        }

        .products-table th,
        .products-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .products-table th {
            background: #f7fafc;
            font-weight: 600;
            color: #4a5568;
            font-size: 14px;
            cursor: pointer;
            user-select: none;
        }

        .products-table th:hover {
            background: #edf2f7;
        }

        .sort-icon {
            margin-left: 4px;
            opacity: 0.5;
        }

        .product-image {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
            background: #f7fafc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .stock-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .stock-low { background: #fed7d7; color: #c53030; }
        .stock-medium { background: #fef5e7; color: #c05621; }
        .stock-high { background: #c6f6d5; color: #22543d; }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            margin-right: 4px;
            transition: all 0.2s;
        }

        .edit-btn {
            background: #4299e1;
            color: white;
        }

        .edit-btn:hover {
            background: #3182ce;
        }

        .delete-btn {
            background: #f56565;
            color: white;
        }

        .delete-btn:hover {
            background: #e53e3e;
        }

        .toggle-btn {
            background: #ed8936;
            color: white;
        }

        .toggle-btn:hover {
            background: #dd6b20;
        }

        .status-update-btn {
            background: #9f7aea;
            color: white;
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            margin-right: 2px;
            transition: all 0.2s;
        }

        .status-update-btn:hover {
            background: #805ad5;
        }

        .status-update-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
        }

        .order-items-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            max-width: 200px;
        }

        .item-badge {
            background: #edf2f7;
            color: #4a5568;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 11px;
            white-space: nowrap;
        }

        .order-details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .detail-section {
            background: #f7fafc;
            border-radius: 8px;
            padding: 16px;
        }

        .detail-section h4 {
            margin: 0 0 12px 0;
            color: #2d3748;
            font-size: 16px;
            font-weight: 600;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .detail-label {
            color: #718096;
            font-weight: 500;
        }

        .detail-value {
            color: #2d3748;
            font-weight: 600;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        .items-table th,
        .items-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .items-table th {
            background: #f7fafc;
            font-weight: 600;
            color: #4a5568;
            font-size: 14px;
        }

        .status-timeline {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 16px 0;
            padding: 16px;
            background: #f7fafc;
            border-radius: 8px;
        }

        .timeline-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }

        .timeline-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 15px;
            right: -50%;
            width: 100%;
            height: 2px;
            background: #e2e8f0;
        }

        .timeline-step.active::after {
            background: #48bb78;
        }

        .timeline-dot {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            margin-bottom: 4px;
            z-index: 1;
        }

        .timeline-step.active .timeline-dot {
            background: #48bb78;
            color: white;
        }

        .timeline-step.completed .timeline-dot {
            background: #48bb78;
            color: white;
        }

        .timeline-label {
            font-size: 11px;
            color: #718096;
            text-align: center;
        }

        .timeline-step.active .timeline-label,
        .timeline-step.completed .timeline-label {
            color: #2d3748;
            font-weight: 600;
        }

        .chart-period-btn {
            background: #e2e8f0;
            color: #4a5568;
            border: none;
            border-radius: 6px;
            padding: 6px 12px;
            margin-right: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .chart-period-btn:hover {
            background: #cbd5e0;
        }

        .chart-period-btn.active {
            background: #667eea;
            color: white;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1003;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 24px 0 24px;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 24px;
        }

        .modal-header h2 {
            margin: 0;
            color: #2d3748;
            font-size: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #718096;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: #f7fafc;
            color: #2d3748;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-group {
            margin-bottom: 16px;
            padding: 0 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #4a5568;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .image-upload {
            position: relative;
        }

        .image-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .image-preview {
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            color: #718096;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-size: cover;
            background-position: center;
        }

        .image-preview:hover {
            border-color: #667eea;
            background-color: #f7fafc;
        }

        .image-preview.has-image {
            border-style: solid;
            border-color: #48bb78;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            padding: 24px;
            border-top: 1px solid #e2e8f0;
            margin-top: 24px;
        }

        .cancel-btn {
            background: #e2e8f0;
            color: #4a5568;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .cancel-btn:hover {
            background: #cbd5e0;
        }

        .save-btn {
            background: #48bb78;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .save-btn:hover {
            background: #38a169;
        }

        /* Dark theme for products */
        .dark-theme .filters-section,
        .dark-theme .products-table-container,
        .dark-theme .modal-content {
            background: rgba(45, 55, 72, 0.95);
            color: #f7fafc;
        }

        .dark-theme .filter-input,
        .dark-theme .filter-select,
        .dark-theme .price-input,
        .dark-theme .form-group input,
        .dark-theme .form-group select,
        .dark-theme .form-group textarea {
            background: #2d3748;
            border-color: #4a5568;
            color: #f7fafc;
        }

        .dark-theme .products-table th {
            background: #2d3748;
            color: #cbd5e0;
        }

        .dark-theme .products-table th:hover {
            background: #4a5568;
        }

        .dark-theme .products-table th,
        .dark-theme .products-table td {
            border-bottom-color: #4a5568;
        }

        .dark-theme .image-preview {
            border-color: #4a5568;
            background-color: #2d3748;
            color: #cbd5e0;
        }

        .dark-theme .image-preview:hover {
            border-color: #667eea;
            background-color: #4a5568;
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .top-nav {
                left: 0;
                padding: 0 60px 0 20px;
            }
            
            .search-container {
                max-width: 200px;
            }
            
            .top-nav-actions {
                gap: 8px;
            }
            
            .theme-toggle {
                padding: 6px 8px;
                font-size: 14px;
            }
            
            .logout-btn {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            .dashboard-container {
                margin-left: 0;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .kpi-grid {
                grid-template-columns: 1fr;
            }
            
            .date-filter {
                flex-direction: column;
                align-items: stretch;
            }
            
            .orders-table {
                font-size: 14px;
            }

            .filter-group {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 10px;
                max-height: 95vh;
            }

            .products-table {
                font-size: 12px;
            }

            .action-btn {
                padding: 4px 8px;
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <button class="mobile-menu-btn" onclick="toggleSidebar()">‚ò∞</button>
    
    <div class="top-nav">
        <div class="search-container">
            <span class="search-icon">üîç</span>
            <input type="text" class="search-input" placeholder="Search products, orders, customers..." id="searchInput" oninput="handleSearch()">
        </div>
        <div class="top-nav-actions">
            <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">
                <span id="themeIcon">üåô</span>
                <span id="themeText">Dark</span>
            </button>
            <button class="logout-btn" onclick="handleLogout()">
                <span>üö™</span>
                Logout
            </button>
        </div>
    </div>
    
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                üè¢ <span>Dashboard</span>
            </div>
        </div>
        <div class="sidebar-nav">
            <a href="#" class="nav-item active" onclick="setActiveNav(this, 'dashboard')">
                <span class="nav-icon">üìä</span>
                Dashboard
            </a>
            <a href="#" class="nav-item" onclick="setActiveNav(this, 'products')">
                <span class="nav-icon">üì¶</span>
                Products
            </a>
            <a href="#" class="nav-item" onclick="setActiveNav(this, 'category')">
                <span class="nav-icon">üè∑Ô∏è</span>
                Category
            </a>
            <a href="#" class="nav-item" onclick="setActiveNav(this, 'orders')">
                <span class="nav-icon">üõí</span>
                Orders
            </a>
            <a href="#" class="nav-item" onclick="setActiveNav(this, 'customers')">
                <span class="nav-icon">üë•</span>
                Customers
            </a>
            <a href="#" class="nav-item" onclick="setActiveNav(this, 'analytics')">
                <span class="nav-icon">üìà</span>
                Analytics
            </a>
        </div>
    </nav>

    <main class="dashboard-container">
        <!-- Dashboard Page -->
        <div id="dashboardPage" class="page-section">
            <header class="header">
                <h1>üìä Dashboard Overview</h1>
                <div class="date-filter">
                    <label for="dateRange">Date Range:</label>
                    <select id="dateRange" onchange="updateDashboard()">
                        <option value="today">Today</option>
                        <option value="week" selected>This Week</option>
                        <option value="month">This Month</option>
                        <option value="quarter">This Quarter</option>
                    </select>
                </div>
            </header>

            <section class="kpi-grid">
                <div class="kpi-card sales">
                    <div class="kpi-header">
                        <span class="kpi-title">Total Sales</span>
                        <div class="kpi-icon" style="background: #c6f6d5;">üí∞</div>
                    </div>
                    <div class="kpi-value" id="totalSales">$24,580</div>
                    <div class="kpi-change positive" id="salesChange">+12.5% from last week</div>
                </div>

                <div class="kpi-card orders">
                    <div class="kpi-header">
                        <span class="kpi-title">Total Orders</span>
                        <div class="kpi-icon" style="background: #bee3f8;">üì¶</div>
                    </div>
                    <div class="kpi-value" id="totalOrders">1,247</div>
                    <div class="kpi-change positive" id="ordersChange">+8.3% from last week</div>
                </div>

                <div class="kpi-card revenue">
                    <div class="kpi-header">
                        <span class="kpi-title">Total Revenue</span>
                        <div class="kpi-icon" style="background: #fbd38d;">üìà</div>
                    </div>
                    <div class="kpi-value" id="totalRevenue">$89,420</div>
                    <div class="kpi-change positive" id="revenueChange">+15.2% from last week</div>
                </div>

                <div class="kpi-card users">
                    <div class="kpi-header">
                        <span class="kpi-title">Active Users</span>
                        <div class="kpi-icon" style="background: #d6bcfa;">üë•</div>
                    </div>
                    <div class="kpi-value" id="activeUsers">3,892</div>
                    <div class="kpi-change positive" id="usersChange">+5.7% from last week</div>
                </div>
            </section>

            <section class="charts-grid">
                <div class="chart-container">
                    <h3 class="chart-title">Sales Trends</h3>
                    <canvas id="salesChart" class="chart-canvas"></canvas>
                </div>

                <div class="chart-container">
                    <h3 class="chart-title">Orders by Category</h3>
                    <canvas id="categoryChart" class="chart-canvas"></canvas>
                </div>
            </section>

            <div class="chart-container" style="margin-bottom: 32px;">
                <h3 class="chart-title">Top Products</h3>
                <canvas id="productsChart" class="chart-canvas"></canvas>
            </div>

            <section class="orders-section">
                <div class="section-header">
                    <h2 class="section-title">Recent Orders</h2>
                    <button class="view-all-btn" onclick="viewAllOrders()">View All Orders</button>
                </div>
                <div style="overflow-x: auto;">
                    <table class="orders-table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Product</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            <!-- Orders will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="notifications">
                <h2 class="section-title" style="margin-bottom: 20px;">Recent Notifications</h2>
                <div id="notificationsList">
                    <!-- Notifications will be populated by JavaScript -->
                </div>
            </section>
        </div>

        <!-- Analytics Page -->
        <div id="analyticsPage" class="page-section" style="display: none;">
            <header class="header">
                <h1>üìà Analytics Dashboard</h1>
                <div class="product-actions">
                    <button class="add-product-btn" onclick="exportAnalytics('csv')" style="background: #48bb78;">
                        <span>üìä</span> Export Data
                    </button>
                    <button class="add-product-btn" onclick="exportAnalytics('pdf')" style="background: #ed8936;">
                        <span>üìÑ</span> Export Report
                    </button>
                </div>
            </header>

            <!-- Analytics Filters -->
            <div class="filters-section">
                <div class="filter-group" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                    <select id="analyticsDateRange" class="filter-select" onchange="updateAnalytics()">
                        <option value="7days">Last 7 Days</option>
                        <option value="30days" selected>Last 30 Days</option>
                        <option value="90days">Last 90 Days</option>
                        <option value="1year">Last Year</option>
                        <option value="custom">Custom Range</option>
                    </select>
                    <select id="analyticsCategoryFilter" class="filter-select" onchange="updateAnalytics()">
                        <option value="">All Categories</option>
                        <option value="Electronics">Electronics</option>
                        <option value="Sports">Sports</option>
                        <option value="Home & Garden">Home & Garden</option>
                        <option value="Books">Books</option>
                        <option value="Clothing">Clothing</option>
                    </select>
                    <select id="analyticsRegionFilter" class="filter-select" onchange="updateAnalytics()">
                        <option value="">All Regions</option>
                        <option value="North America">North America</option>
                        <option value="Europe">Europe</option>
                        <option value="Asia">Asia</option>
                        <option value="Other">Other</option>
                    </select>
                    <button class="view-all-btn" onclick="resetAnalyticsFilters()">Reset Filters</button>
                </div>
                <div id="customDateRange" style="display: none; margin-top: 12px; gap: 12px;">
                    <input type="date" id="analyticsDateFrom" class="filter-input" onchange="updateAnalytics()" style="width: 200px;">
                    <input type="date" id="analyticsDateTo" class="filter-input" onchange="updateAnalytics()" style="width: 200px;">
                </div>
            </div>

            <!-- Analytics KPIs -->
            <section class="kpi-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
                <div class="kpi-card sales">
                    <div class="kpi-header">
                        <span class="kpi-title">Average Order Value</span>
                        <div class="kpi-icon" style="background: #c6f6d5;">üí∞</div>
                    </div>
                    <div class="kpi-value" id="avgOrderValue">$164.25</div>
                    <div class="kpi-change positive" id="aovChange">+8.2% from last period</div>
                </div>

                <div class="kpi-card orders">
                    <div class="kpi-header">
                        <span class="kpi-title">Customer Lifetime Value</span>
                        <div class="kpi-icon" style="background: #bee3f8;">üë•</div>
                    </div>
                    <div class="kpi-value" id="customerLTV">$892.50</div>
                    <div class="kpi-change positive" id="clvChange">+12.4% from last period</div>
                </div>

                <div class="kpi-card revenue">
                    <div class="kpi-header">
                        <span class="kpi-title">Conversion Rate</span>
                        <div class="kpi-icon" style="background: #fbd38d;">üìä</div>
                    </div>
                    <div class="kpi-value" id="conversionRate">3.24%</div>
                    <div class="kpi-change positive" id="conversionChange">+0.8% from last period</div>
                </div>

                <div class="kpi-card users">
                    <div class="kpi-header">
                        <span class="kpi-title">Return Customer Rate</span>
                        <div class="kpi-icon" style="background: #d6bcfa;">üîÑ</div>
                    </div>
                    <div class="kpi-value" id="returnRate">42.8%</div>
                    <div class="kpi-change positive" id="returnChange">+5.1% from last period</div>
                </div>
            </section>

            <!-- Main Analytics Charts -->
            <div class="charts-grid" style="grid-template-columns: 2fr 1fr; margin-bottom: 24px;">
                <div class="chart-container">
                    <h3 class="chart-title">Sales Trends</h3>
                    <div style="margin-bottom: 16px;">
                        <button class="chart-period-btn active" onclick="setSalesPeriod('day')">Daily</button>
                        <button class="chart-period-btn" onclick="setSalesPeriod('week')">Weekly</button>
                        <button class="chart-period-btn" onclick="setSalesPeriod('month')">Monthly</button>
                    </div>
                    <canvas id="analyticsSalesChart" class="chart-canvas"></canvas>
                </div>

                <div class="chart-container">
                    <h3 class="chart-title">Customer Types</h3>
                    <canvas id="customerTypesChart" class="chart-canvas"></canvas>
                </div>
            </div>

            <!-- Revenue vs Orders Chart -->
            <div class="chart-container" style="margin-bottom: 24px;">
                <h3 class="chart-title">Revenue vs Orders Correlation</h3>
                <canvas id="revenueOrdersChart" class="chart-canvas"></canvas>
            </div>

            <!-- Order Analytics Section -->
            <div class="chart-container" style="margin-bottom: 24px;">
                <h3 class="chart-title">üì¶ Order Analytics</h3>
                <div class="charts-grid" style="grid-template-columns: 2fr 1fr; gap: 20px;">
                    <div>
                        <h4 style="margin: 0 0 16px 0; color: #4a5568; font-size: 16px;">Order Count Over Time</h4>
                        <canvas id="orderCountChart" class="chart-canvas" style="max-height: 250px;"></canvas>
                    </div>
                    <div>
                        <h4 style="margin: 0 0 16px 0; color: #4a5568; font-size: 16px;">Order Status Distribution</h4>
                        <canvas id="orderStatusChart" class="chart-canvas" style="max-height: 250px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Order Metrics Grid -->
            <div class="charts-grid" style="grid-template-columns: 1fr 1fr 1fr; margin-bottom: 24px;">
                <div class="chart-container">
                    <h4 class="chart-title">Average Order Value Trend</h4>
                    <canvas id="aovTrendChart" class="chart-canvas"></canvas>
                </div>
                <div class="chart-container">
                    <h4 class="chart-title">Order Completion Rate</h4>
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 48px; font-weight: bold; color: #48bb78; margin-bottom: 8px;" id="completionRate">87.3%</div>
                        <div style="color: #718096; margin-bottom: 16px;">Orders Successfully Delivered</div>
                        <div style="display: flex; justify-content: space-between; font-size: 14px;">
                            <div>
                                <div style="color: #48bb78; font-weight: 600;" id="deliveredCount">524</div>
                                <div style="color: #718096;">Delivered</div>
                            </div>
                            <div>
                                <div style="color: #f56565; font-weight: 600;" id="cancelledCount">76</div>
                                <div style="color: #718096;">Cancelled</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <h4 class="chart-title">Monthly Order Growth</h4>
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 48px; font-weight: bold; color: #667eea; margin-bottom: 8px;">+23.4%</div>
                        <div style="color: #718096; margin-bottom: 16px;">vs Last Month</div>
                        <div style="display: flex; justify-content: space-between; font-size: 14px;">
                            <div>
                                <div style="color: #667eea; font-weight: 600;">1,247</div>
                                <div style="color: #718096;">This Month</div>
                            </div>
                            <div>
                                <div style="color: #a0aec0; font-weight: 600;">1,010</div>
                                <div style="color: #718096;">Last Month</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customer Analytics Section -->
            <div class="chart-container" style="margin-bottom: 24px;">
                <h3 class="chart-title">üë• Customer Analytics</h3>
                <div class="charts-grid" style="grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                    <div>
                        <h4 style="margin: 0 0 16px 0; color: #4a5568; font-size: 16px;">Customer Activity Status</h4>
                        <canvas id="customerActivityChart" class="chart-canvas" style="max-height: 250px;"></canvas>
                    </div>
                    <div>
                        <h4 style="margin: 0 0 16px 0; color: #4a5568; font-size: 16px;">Customer Lifetime Value Distribution</h4>
                        <canvas id="clvDistributionChart" class="chart-canvas" style="max-height: 250px;"></canvas>
                    </div>
                    <div>
                        <h4 style="margin: 0 0 16px 0; color: #4a5568; font-size: 16px;">Top Buyers</h4>
                        <div style="max-height: 250px; overflow-y: auto;">
                            <table style="width: 100%; font-size: 12px;">
                                <thead>
                                    <tr style="background: #f7fafc;">
                                        <th style="padding: 8px; text-align: left;">Customer</th>
                                        <th style="padding: 8px; text-align: right;">Total Spend</th>
                                    </tr>
                                </thead>
                                <tbody id="topBuyersTable">
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Product Analytics Section -->
            <div class="chart-container" style="margin-bottom: 24px;">
                <h3 class="chart-title">üìä Product Analytics</h3>
                <div class="charts-grid" style="grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <h4 style="margin: 0 0 16px 0; color: #4a5568; font-size: 16px;">Stock-Out Frequency</h4>
                        <canvas id="stockOutChart" class="chart-canvas" style="max-height: 250px;"></canvas>
                    </div>
                    <div>
                        <h4 style="margin: 0 0 16px 0; color: #4a5568; font-size: 16px;">Product Views vs Purchases</h4>
                        <canvas id="conversionFunnelChart" class="chart-canvas" style="max-height: 250px;"></canvas>
                    </div>
                </div>
                <div class="charts-grid" style="grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h4 style="margin: 0 0 16px 0; color: #4a5568; font-size: 16px;">Profit Margin by Product</h4>
                        <canvas id="profitMarginChart" class="chart-canvas" style="max-height: 250px;"></canvas>
                    </div>
                    <div>
                        <h4 style="margin: 0 0 16px 0; color: #4a5568; font-size: 16px;">Top Selling Products (Units)</h4>
                        <div style="max-height: 250px; overflow-y: auto;">
                            <table style="width: 100%; font-size: 12px;">
                                <thead>
                                    <tr style="background: #f7fafc;">
                                        <th style="padding: 8px; text-align: left;">Product</th>
                                        <th style="padding: 8px; text-align: right;">Units</th>
                                        <th style="padding: 8px; text-align: right;">Revenue</th>
                                    </tr>
                                </thead>
                                <tbody id="topSellingTable">
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Category and Product Performance -->
            <div class="charts-grid" style="grid-template-columns: 1fr 1fr; margin-bottom: 24px;">
                <div class="chart-container">
                    <h3 class="chart-title">Top Categories by Revenue</h3>
                    <canvas id="topCategoriesChart" class="chart-canvas"></canvas>
                </div>

                <div class="chart-container">
                    <h3 class="chart-title">Product Performance</h3>
                    <canvas id="productPerformanceChart" class="chart-canvas"></canvas>
                </div>
            </div>

            <!-- Detailed Analytics Tables -->
            <div class="charts-grid" style="grid-template-columns: 1fr 1fr;">
                <div class="products-table-container">
                    <h3 class="chart-title" style="margin-bottom: 16px;">Top Products by Revenue</h3>
                    <table class="products-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Units Sold</th>
                                <th>Revenue</th>
                                <th>% of Total</th>
                            </tr>
                        </thead>
                        <tbody id="topProductsTable">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <div class="products-table-container">
                    <h3 class="chart-title" style="margin-bottom: 16px;">Regional Performance</h3>
                    <table class="products-table">
                        <thead>
                            <tr>
                                <th>Region</th>
                                <th>Orders</th>
                                <th>Revenue</th>
                                <th>AOV</th>
                            </tr>
                        </thead>
                        <tbody id="regionalTable">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Customers Page -->
        <div id="customersPage" class="page-section" style="display: none;">
            <header class="header">
                <h1>üë• Customer Management</h1>
                <div class="product-actions">
                    <button class="add-product-btn" onclick="exportCustomers('csv')" style="background: #48bb78;">
                        <span>üìä</span> Export CSV
                    </button>
                    <button class="add-product-btn" onclick="exportCustomers('pdf')" style="background: #ed8936;">
                        <span>üìÑ</span> Export PDF
                    </button>
                </div>
            </header>

            <!-- Customer Filters -->
            <div class="filters-section">
                <div class="filter-group" style="grid-template-columns: 2fr 1fr 1fr 1fr;">
                    <input type="text" id="customerSearch" placeholder="Search by name or email..." class="filter-input" oninput="filterCustomers()">
                    <select id="customerStatusFilter" class="filter-select" onchange="filterCustomers()">
                        <option value="">All Status</option>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                        <option value="disabled">Disabled</option>
                    </select>
                    <select id="customerOrdersFilter" class="filter-select" onchange="filterCustomers()">
                        <option value="">All Customers</option>
                        <option value="new">New (0 orders)</option>
                        <option value="low">Low (1-5 orders)</option>
                        <option value="medium">Medium (6-20 orders)</option>
                        <option value="high">High (20+ orders)</option>
                    </select>
                    <input type="date" id="customerDateFrom" class="filter-input" onchange="filterCustomers()" title="Signup Date From">
                </div>
                <div style="margin-top: 12px; display: flex; gap: 12px;">
                    <button class="view-all-btn" onclick="clearCustomerFilters()">Clear Filters</button>
                    <span id="customerCount" style="color: #718096; font-size: 14px; align-self: center;"></span>
                </div>
            </div>

            <!-- Customer Stats Cards -->
            <section class="kpi-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); margin-bottom: 24px;">
                <div class="kpi-card users">
                    <div class="kpi-header">
                        <span class="kpi-title">Total Customers</span>
                        <div class="kpi-icon" style="background: #d6bcfa;">üë•</div>
                    </div>
                    <div class="kpi-value" id="totalCustomers">2,847</div>
                    <div class="kpi-change positive" id="customersGrowth">+12.4% this month</div>
                </div>

                <div class="kpi-card sales">
                    <div class="kpi-header">
                        <span class="kpi-title">Active Customers</span>
                        <div class="kpi-icon" style="background: #c6f6d5;">‚úÖ</div>
                    </div>
                    <div class="kpi-value" id="activeCustomers">2,634</div>
                    <div class="kpi-change positive" id="activeGrowth">92.5% active rate</div>
                </div>

                <div class="kpi-card orders">
                    <div class="kpi-header">
                        <span class="kpi-title">New This Month</span>
                        <div class="kpi-icon" style="background: #bee3f8;">üÜï</div>
                    </div>
                    <div class="kpi-value" id="newCustomers">189</div>
                    <div class="kpi-change positive" id="newGrowth">+8.7% vs last month</div>
                </div>

                <div class="kpi-card revenue">
                    <div class="kpi-header">
                        <span class="kpi-title">Avg. Lifetime Value</span>
                        <div class="kpi-icon" style="background: #fbd38d;">üí∞</div>
                    </div>
                    <div class="kpi-value" id="avgLifetimeValue">$892</div>
                    <div class="kpi-change positive" id="clvGrowth">+15.2% increase</div>
                </div>
            </section>

            <!-- Customers Table -->
            <div class="products-table-container">
                <table class="products-table">
                    <thead>
                        <tr>
                            <th onclick="sortCustomers('name')">Customer <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCustomers('email')">Email <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCustomers('signupDate')">Signup Date <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCustomers('totalOrders')">Total Orders <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCustomers('totalSpent')">Total Spent <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCustomers('lastLogin')">Last Login <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCustomers('status')">Status <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="customersTableBody">
                        <!-- Customers will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Customer Details Modal -->
        <div id="customerDetailsModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 900px;">
                <div class="modal-header">
                    <h2 id="customerDetailsTitle">Customer Details</h2>
                    <button class="close-btn" onclick="closeCustomerDetails()">‚úï</button>
                </div>
                <div id="customerDetailsContent" style="padding: 0 24px 24px 24px;">
                    <!-- Customer details will be populated here -->
                </div>
            </div>
        </div>

        <!-- Orders Page -->
        <div id="ordersPage" class="page-section" style="display: none;">
            <header class="header">
                <h1>üõí Order Management</h1>
                <div class="product-actions">
                    <button class="add-product-btn" onclick="exportOrders('csv')" style="background: #48bb78;">
                        <span>üìä</span> Export CSV
                    </button>
                    <button class="add-product-btn" onclick="exportOrders('pdf')" style="background: #ed8936;">
                        <span>üìÑ</span> Export PDF
                    </button>
                </div>
            </header>

            <!-- Order Filters -->
            <div class="filters-section">
                <div class="filter-group" style="grid-template-columns: 2fr 1fr 1fr 1fr;">
                    <input type="text" id="orderSearch" placeholder="Search by Order ID or Customer..." class="filter-input" oninput="filterOrders()">
                    <select id="orderStatusFilter" class="filter-select" onchange="filterOrders()">
                        <option value="">All Status</option>
                        <option value="pending">Pending</option>
                        <option value="processing">Processing</option>
                        <option value="shipped">Shipped</option>
                        <option value="delivered">Delivered</option>
                        <option value="cancelled">Cancelled</option>
                    </select>
                    <input type="date" id="orderDateFrom" class="filter-input" onchange="filterOrders()" title="From Date">
                    <input type="date" id="orderDateTo" class="filter-input" onchange="filterOrders()" title="To Date">
                </div>
                <div style="margin-top: 12px; display: flex; gap: 12px;">
                    <button class="view-all-btn" onclick="clearOrderFilters()">Clear Filters</button>
                    <span id="orderCount" style="color: #718096; font-size: 14px; align-self: center;"></span>
                </div>
            </div>

            <!-- Orders Table -->
            <div class="products-table-container">
                <table class="products-table">
                    <thead>
                        <tr>
                            <th onclick="sortOrders('id')">Order ID <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortOrders('customer')">Customer <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortOrders('items')">Items <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortOrders('total')">Total <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortOrders('status')">Status <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortOrders('date')">Order Date <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <!-- Orders will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Order Details Modal -->
        <div id="orderDetailsModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h2 id="orderDetailsTitle">Order Details</h2>
                    <button class="close-btn" onclick="closeOrderDetails()">‚úï</button>
                </div>
                <div id="orderDetailsContent" style="padding: 0 24px 24px 24px;">
                    <!-- Order details will be populated here -->
                </div>
            </div>
        </div>

        <!-- Categories Page -->
        <div id="categoriesPage" class="page-section" style="display: none;">
            <header class="header">
                <h1>üóÇÔ∏è Category Management</h1>
                <div class="product-actions">
                    <button class="add-product-btn" onclick="showAddCategory()">
                        <span>‚ûï</span> Add New Category
                    </button>
                </div>
            </header>

            <!-- Category Filters -->
            <div class="filters-section">
                <div class="filter-group" style="grid-template-columns: 2fr 1fr 1fr 1fr;">
                    <input type="text" id="categorySearch" placeholder="Search categories..." class="filter-input" oninput="filterCategories()">
                    <select id="productCountFilter" class="filter-select" onchange="filterCategories()">
                        <option value="">All Categories</option>
                        <option value="empty">Empty (0 products)</option>
                        <option value="low">Low (1-10 products)</option>
                        <option value="medium">Medium (11-50 products)</option>
                        <option value="high">High (50+ products)</option>
                    </select>
                    <select id="categoryStatusFilter" class="filter-select" onchange="filterCategories()">
                        <option value="">All Status</option>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                    <button class="view-all-btn" onclick="clearCategoryFilters()">Clear Filters</button>
                </div>
            </div>

            <!-- Categories Table -->
            <div class="products-table-container">
                <table class="products-table">
                    <thead>
                        <tr>
                            <th onclick="sortCategories('name')">Category Name <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCategories('description')">Description <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCategories('productCount')">Product Count <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCategories('status')">Status <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortCategories('createdDate')">Created Date <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="categoriesTableBody">
                        <!-- Categories will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Products Page -->
        <div id="productsPage" class="page-section" style="display: none;">
            <header class="header">
                <h1>üì¶ Product Management</h1>
                <div class="product-actions">
                    <button class="add-product-btn" onclick="showAddProduct()">
                        <span>‚ûï</span> Add New Product
                    </button>
                </div>
            </header>

            <!-- Product Filters -->
            <div class="filters-section">
                <div class="filter-group">
                    <input type="text" id="productSearch" placeholder="Search products..." class="filter-input" oninput="filterProducts()">
                    <select id="categoryFilter" class="filter-select" onchange="filterProducts()">
                        <option value="">All Categories</option>
                        <option value="Electronics">Electronics</option>
                        <option value="Clothing">Clothing</option>
                        <option value="Books">Books</option>
                        <option value="Home & Garden">Home & Garden</option>
                        <option value="Sports">Sports</option>
                    </select>
                    <select id="statusFilter" class="filter-select" onchange="filterProducts()">
                        <option value="">All Status</option>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                    <div class="price-range">
                        <input type="number" id="minPrice" placeholder="Min Price" class="price-input" oninput="filterProducts()">
                        <input type="number" id="maxPrice" placeholder="Max Price" class="price-input" oninput="filterProducts()">
                    </div>
                </div>
            </div>

            <!-- Products Table -->
            <div class="products-table-container">
                <table class="products-table">
                    <thead>
                        <tr>
                            <th onclick="sortProducts('name')">Product Name <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortProducts('category')">Category <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortProducts('price')">Price <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortProducts('stock')">Stock <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th onclick="sortProducts('status')">Status <span class="sort-icon">‚ÜïÔ∏è</span></th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- Products will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Add/Edit Category Modal -->
        <div id="categoryModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="categoryModalTitle">Add New Category</h2>
                    <button class="close-btn" onclick="closeCategoryModal()">‚úï</button>
                </div>
                <form id="categoryForm" onsubmit="saveCategory(event)">
                    <div class="form-group">
                        <label for="categoryName">Category Name *</label>
                        <input type="text" id="categoryName" required>
                    </div>
                    <div class="form-group">
                        <label for="categoryDescription">Description</label>
                        <textarea id="categoryDescription" rows="3" placeholder="Brief description of this category..."></textarea>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="categoryIcon">Category Icon</label>
                            <select id="categoryIcon">
                                <option value="üì±">üì± Electronics</option>
                                <option value="üëï">üëï Clothing</option>
                                <option value="üìö">üìö Books</option>
                                <option value="üè†">üè† Home & Garden</option>
                                <option value="‚öΩ">‚öΩ Sports</option>
                                <option value="üéÆ">üéÆ Gaming</option>
                                <option value="üçî">üçî Food & Beverage</option>
                                <option value="üíÑ">üíÑ Beauty</option>
                                <option value="üöó">üöó Automotive</option>
                                <option value="üéµ">üéµ Music</option>
                                <option value="üé®">üé® Art & Crafts</option>
                                <option value="üè•">üè• Health</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="categoryStatus">Status</label>
                            <select id="categoryStatus">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="categoryProducts">Assign Products</label>
                        <div id="productAssignment" style="max-height: 200px; overflow-y: auto; border: 2px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                            <!-- Product checkboxes will be populated here -->
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeCategoryModal()">Cancel</button>
                        <button type="submit" class="save-btn">Save Category</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add/Edit Product Modal -->
        <div id="productModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalTitle">Add New Product</h2>
                    <button class="close-btn" onclick="closeProductModal()">‚úï</button>
                </div>
                <form id="productForm" onsubmit="saveProduct(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="productName">Product Name *</label>
                            <input type="text" id="productName" required>
                        </div>
                        <div class="form-group">
                            <label for="productCategory">Category *</label>
                            <select id="productCategory" required>
                                <option value="">Select Category</option>
                                <option value="Electronics">Electronics</option>
                                <option value="Clothing">Clothing</option>
                                <option value="Books">Books</option>
                                <option value="Home & Garden">Home & Garden</option>
                                <option value="Sports">Sports</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="productPrice">Price *</label>
                            <input type="number" id="productPrice" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="productStock">Stock Quantity *</label>
                            <input type="number" id="productStock" required>
                        </div>
                        <div class="form-group">
                            <label for="productBrand">Brand</label>
                            <input type="text" id="productBrand">
                        </div>
                        <div class="form-group">
                            <label for="productStatus">Status</label>
                            <select id="productStatus">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="productDescription">Description</label>
                        <textarea id="productDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="productImage">Product Image</label>
                        <div class="image-upload">
                            <input type="file" id="productImage" accept="image/*" onchange="previewImage(event)">
                            <div class="image-preview" id="imagePreview">
                                <span>üì∑ Click to upload image</span>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="closeProductModal()">Cancel</button>
                        <button type="submit" class="save-btn">Save Product</button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <script>
        // Sample data
        const dashboardData = {
            today: {
                sales: '$8,420',
                orders: 156,
                revenue: '$28,340',
                users: 892,
                salesChange: '+5.2% from yesterday',
                ordersChange: '+12.1% from yesterday',
                revenueChange: '+8.7% from yesterday',
                usersChange: '+3.4% from yesterday'
            },
            week: {
                sales: '$24,580',
                orders: 1247,
                revenue: '$89,420',
                users: 3892,
                salesChange: '+12.5% from last week',
                ordersChange: '+8.3% from last week',
                revenueChange: '+15.2% from last week',
                usersChange: '+5.7% from last week'
            },
            month: {
                sales: '$156,780',
                orders: 8934,
                revenue: '$542,180',
                users: 15672,
                salesChange: '+18.9% from last month',
                ordersChange: '+22.4% from last month',
                revenueChange: '+16.8% from last month',
                usersChange: '+11.3% from last month'
            },
            quarter: {
                sales: '$487,920',
                orders: 26801,
                revenue: '$1,628,540',
                users: 47238,
                salesChange: '+24.7% from last quarter',
                ordersChange: '+19.6% from last quarter',
                revenueChange: '+28.3% from last quarter',
                usersChange: '+15.9% from last quarter'
            }
        };

        const recentOrders = [
            { id: '#ORD-2024-001', customer: 'John Smith', product: 'Wireless Headphones', amount: '$129.99', status: 'completed', date: '2024-01-15' },
            { id: '#ORD-2024-002', customer: 'Sarah Johnson', product: 'Smart Watch', amount: '$299.99', status: 'processing', date: '2024-01-15' },
            { id: '#ORD-2024-003', customer: 'Mike Davis', product: 'Laptop Stand', amount: '$79.99', status: 'pending', date: '2024-01-14' },
            { id: '#ORD-2024-004', customer: 'Emily Brown', product: 'Bluetooth Speaker', amount: '$89.99', status: 'completed', date: '2024-01-14' },
            { id: '#ORD-2024-005', customer: 'David Wilson', product: 'Phone Case', amount: '$24.99', status: 'completed', date: '2024-01-14' },
            { id: '#ORD-2024-006', customer: 'Lisa Garcia', product: 'Tablet', amount: '$399.99', status: 'processing', date: '2024-01-13' },
            { id: '#ORD-2024-007', customer: 'Tom Anderson', product: 'Keyboard', amount: '$149.99', status: 'pending', date: '2024-01-13' },
            { id: '#ORD-2024-008', customer: 'Anna Martinez', product: 'Mouse Pad', amount: '$19.99', status: 'completed', date: '2024-01-13' }
        ];

        const notifications = [
            { icon: 'üîî', bg: '#bee3f8', text: 'New order received from premium customer', time: '5 minutes ago' },
            { icon: 'üìä', bg: '#c6f6d5', text: 'Weekly sales report is ready for review', time: '1 hour ago' },
            { icon: '‚ö†Ô∏è', bg: '#fef5e7', text: 'Low stock alert: Wireless Headphones', time: '2 hours ago' },
            { icon: '‚úÖ', bg: '#c6f6d5', text: 'Payment processed successfully', time: '3 hours ago' },
            { icon: 'üë§', bg: '#d6bcfa', text: 'New user registration', time: '4 hours ago' }
        ];

        let salesChart, categoryChart, productsChart;
        let analyticsSalesChart, customerTypesChart, revenueOrdersChart, topCategoriesChart, productPerformanceChart;
        let orderCountChart, orderStatusChart, aovTrendChart, customerActivityChart, clvDistributionChart;
        let stockOutChart, conversionFunnelChart, profitMarginChart;
        let currentSalesPeriod = 'day';

        // Analytics data - connected to dashboard data
        const analyticsData = {
            salesTrends: {
                daily: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    sales: [3200, 4100, 3800, 5200, 4800, 6100, 5900],
                    orders: [24, 31, 28, 39, 36, 45, 42],
                    revenue: [4800, 6150, 5700, 7800, 7200, 9150, 8850]
                },
                weekly: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                    sales: [22400, 28700, 31200, 26800],
                    orders: [168, 215, 234, 201],
                    revenue: [33600, 43050, 46800, 40200]
                },
                monthly: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    sales: [89400, 95200, 102800, 87600, 94300, 108900],
                    orders: [672, 714, 771, 658, 708, 817],
                    revenue: [134100, 142800, 154200, 131400, 141450, 163350]
                }
            },
            customerTypes: {
                labels: ['New Customers', 'Returning Customers'],
                data: [57.2, 42.8],
                colors: ['#667eea', '#48bb78']
            },
            topCategories: {
                labels: ['Electronics', 'Sports', 'Home & Garden', 'Books', 'Clothing'],
                revenue: [45600, 28900, 18700, 12400, 8900],
                colors: ['#667eea', '#48bb78', '#ed8936', '#9f7aea', '#4299e1'],
                orders: [342, 198, 124, 89, 67],
                units: [1245, 892, 456, 234, 178]
            },
            productPerformance: [
                { name: 'Smart Watch', unitsSold: 189, revenue: 56697.11, percentage: 32.4, category: 'Electronics' },
                { name: 'Wireless Headphones', unitsSold: 245, revenue: 31855.55, percentage: 18.2, category: 'Electronics' },
                { name: 'Coffee Maker', unitsSold: 156, revenue: 24958.44, percentage: 14.3, category: 'Home & Garden' },
                { name: 'Running Shoes', unitsSold: 134, revenue: 12053.66, percentage: 6.9, category: 'Sports' },
                { name: 'Yoga Mat', unitsSold: 298, revenue: 8937.02, percentage: 5.1, category: 'Sports' },
                { name: 'Bluetooth Speaker', unitsSold: 98, revenue: 8799.02, percentage: 5.0, category: 'Electronics' }
            ],
            regionalData: [
                { region: 'North America', orders: 1247, revenue: 89420.50, aov: 71.73, customers: 892 },
                { region: 'Europe', orders: 892, revenue: 67834.20, aov: 76.05, customers: 634 },
                { region: 'Asia', orders: 634, revenue: 45672.80, aov: 72.04, customers: 445 },
                { region: 'Other', orders: 289, revenue: 18934.60, aov: 65.52, customers: 198 }
            ],
            // Order Analytics Data
            orderAnalytics: {
                orderCountOverTime: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'],
                    data: [156, 189, 234, 198, 267, 289],
                    colors: '#667eea'
                },
                orderStatusDistribution: {
                    labels: ['Delivered', 'Shipped', 'Processing', 'Pending', 'Cancelled'],
                    data: [524, 189, 156, 98, 76],
                    colors: ['#48bb78', '#4299e1', '#ed8936', '#9f7aea', '#f56565']
                },
                aovTrend: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    data: [142.50, 156.80, 164.25, 159.90, 168.40, 172.30],
                    colors: '#667eea'
                },
                completionMetrics: {
                    delivered: 524,
                    cancelled: 76,
                    completionRate: 87.3
                }
            },
            // Customer Analytics Data
            customerAnalytics: {
                activityStatus: {
                    labels: ['Active Users', 'Inactive Users'],
                    data: [2847, 1045],
                    colors: ['#48bb78', '#cbd5e0']
                },
                clvDistribution: {
                    labels: ['$0-$500', '$500-$1000', '$1000-$2000', '$2000+'],
                    data: [1245, 892, 456, 299],
                    colors: ['#f56565', '#ed8936', '#48bb78', '#667eea']
                },
                topBuyers: [
                    { name: 'Sarah Johnson', email: 'sarah.j@email.com', totalSpend: 2847.50, orders: 12 },
                    { name: 'Michael Chen', email: 'm.chen@email.com', totalSpend: 2156.80, orders: 8 },
                    { name: 'Emily Rodriguez', email: 'emily.r@email.com', totalSpend: 1923.45, orders: 15 },
                    { name: 'David Kim', email: 'david.kim@email.com', totalSpend: 1789.20, orders: 7 },
                    { name: 'Lisa Thompson', email: 'lisa.t@email.com', totalSpend: 1654.90, orders: 11 },
                    { name: 'James Wilson', email: 'j.wilson@email.com', totalSpend: 1432.75, orders: 9 },
                    { name: 'Anna Martinez', email: 'anna.m@email.com', totalSpend: 1298.60, orders: 6 },
                    { name: 'Robert Brown', email: 'r.brown@email.com', totalSpend: 1156.40, orders: 10 }
                ]
            },
            // Product Analytics Data
            productAnalytics: {
                stockOutFrequency: {
                    labels: ['Smart Watch', 'Running Shoes', 'Wireless Headphones', 'Coffee Maker', 'Yoga Mat'],
                    data: [8, 12, 5, 3, 2], // Number of stock-out incidents
                    colors: ['#f56565', '#ed8936', '#48bb78', '#4299e1', '#9f7aea']
                },
                conversionFunnel: {
                    labels: ['Product Views', 'Add to Cart', 'Purchases'],
                    data: [15420, 3847, 1247],
                    colors: ['#667eea', '#48bb78', '#ed8936']
                },
                profitMargins: {
                    labels: ['Smart Watch', 'Headphones', 'Coffee Maker', 'Running Shoes', 'Yoga Mat', 'Speaker'],
                    data: [45.2, 38.7, 52.1, 41.3, 65.8, 35.9], // Profit margin percentages
                    costs: [164.49, 84.49, 79.99, 53.94, 11.99, 51.99], // Cost prices
                    colors: ['#667eea', '#48bb78', '#ed8936', '#9f7aea', '#4299e1', '#f56565']
                },
                topSellingProducts: [
                    { name: 'Smart Watch', units: 189, revenue: 56697.11, views: 4520, conversions: 4.18 },
                    { name: 'Wireless Headphones', units: 245, revenue: 31855.55, views: 3890, conversions: 6.30 },
                    { name: 'Coffee Maker', units: 156, revenue: 24958.44, views: 2340, conversions: 6.67 },
                    { name: 'Running Shoes', units: 134, revenue: 12053.66, views: 2890, conversions: 4.64 },
                    { name: 'Yoga Mat', units: 298, revenue: 8937.02, views: 1560, conversions: 19.10 },
                    { name: 'Bluetooth Speaker', units: 98, revenue: 8799.02, views: 1890, conversions: 5.19 }
                ]
            },
            // Connect to dashboard totals
            totals: {
                totalRevenue: 175000,
                totalOrders: 3062,
                totalCustomers: 2169,
                avgOrderValue: 164.25
            }
        };

        function updateDashboard() {
            const selectedRange = document.getElementById('dateRange').value;
            const data = dashboardData[selectedRange];

            // Update KPI cards
            document.getElementById('totalSales').textContent = data.sales;
            document.getElementById('totalOrders').textContent = data.orders;
            document.getElementById('totalRevenue').textContent = data.revenue;
            document.getElementById('activeUsers').textContent = data.users;

            document.getElementById('salesChange').textContent = data.salesChange;
            document.getElementById('ordersChange').textContent = data.ordersChange;
            document.getElementById('revenueChange').textContent = data.revenueChange;
            document.getElementById('usersChange').textContent = data.usersChange;

            // Update analytics totals to match dashboard
            analyticsData.totals = {
                totalRevenue: parseFloat(data.revenue.replace(/[$,]/g, '')),
                totalOrders: parseInt(data.orders.replace(/,/g, '')),
                totalCustomers: parseInt(data.users.replace(/,/g, '')),
                avgOrderValue: parseFloat(data.revenue.replace(/[$,]/g, '')) / parseInt(data.orders.replace(/,/g, ''))
            };

            // Update charts with new data
            updateCharts();
        }

        function initializeCharts() {
            // Sales Trends Chart
            const salesCtx = document.getElementById('salesChart').getContext('2d');
            salesChart = new Chart(salesCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Sales ($)',
                        data: [3200, 4100, 3800, 5200, 4800, 6100, 5900],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Category Chart
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            categoryChart = new Chart(categoryCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Electronics', 'Clothing', 'Books', 'Home & Garden', 'Sports'],
                    datasets: [{
                        data: [35, 25, 15, 15, 10],
                        backgroundColor: [
                            '#667eea',
                            '#764ba2',
                            '#48bb78',
                            '#ed8936',
                            '#9f7aea'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        }
                    }
                }
            });

            // Top Products Chart
            const productsCtx = document.getElementById('productsChart').getContext('2d');
            productsChart = new Chart(productsCtx, {
                type: 'bar',
                data: {
                    labels: ['Wireless Headphones', 'Smart Watch', 'Laptop Stand', 'Bluetooth Speaker', 'Phone Case'],
                    datasets: [{
                        label: 'Sales',
                        data: [245, 189, 156, 134, 98],
                        backgroundColor: [
                            '#667eea',
                            '#48bb78',
                            '#ed8936',
                            '#9f7aea',
                            '#4299e1'
                        ],
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        function updateCharts() {
            // Update chart data based on selected date range
            const selectedRange = document.getElementById('dateRange').value;
            
            // Update sales chart data
            let salesData;
            switch(selectedRange) {
                case 'today':
                    salesData = [420, 680, 520, 890, 1200, 980, 1150];
                    break;
                case 'week':
                    salesData = [3200, 4100, 3800, 5200, 4800, 6100, 5900];
                    break;
                case 'month':
                    salesData = [12000, 15000, 13500, 18000, 16500, 21000, 19500];
                    break;
                case 'quarter':
                    salesData = [45000, 52000, 48000, 61000, 58000, 67000, 63000];
                    break;
            }
            
            salesChart.data.datasets[0].data = salesData;
            salesChart.update();
        }

        function populateOrdersTable() {
            const tbody = document.getElementById('ordersTableBody');
            tbody.innerHTML = '';

            recentOrders.forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${order.id}</strong></td>
                    <td>${order.customer}</td>
                    <td>${order.product}</td>
                    <td><strong>${order.amount}</strong></td>
                    <td><span class="status-badge status-${order.status}">${order.status}</span></td>
                    <td>${order.date}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function populateNotifications() {
            const container = document.getElementById('notificationsList');
            container.innerHTML = '';

            notifications.forEach(notification => {
                const item = document.createElement('div');
                item.className = 'notification-item';
                item.innerHTML = `
                    <div class="notification-icon" style="background: ${notification.bg};">
                        ${notification.icon}
                    </div>
                    <div class="notification-content">
                        <div class="notification-text">${notification.text}</div>
                        <div class="notification-time">${notification.time}</div>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        function viewAllOrders() {
            setActiveNav(document.querySelector('.nav-item[onclick*="orders"]'), 'orders');
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        function setActiveNav(element, section) {
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to clicked item
            element.classList.add('active');
            
            // Show appropriate content based on section
            showSection(section);
        }

        function showSection(section) {
            const dashboardContent = document.querySelector('.dashboard-container');
            
            // Hide all sections first
            document.querySelectorAll('.page-section').forEach(page => {
                page.style.display = 'none';
            });
            
            switch(section) {
                case 'dashboard':
                    document.getElementById('dashboardPage').style.display = 'block';
                    break;
                case 'products':
                    document.getElementById('productsPage').style.display = 'block';
                    loadProducts();
                    break;
                case 'category':
                    document.getElementById('categoriesPage').style.display = 'block';
                    loadCategories();
                    break;
                case 'orders':
                    document.getElementById('ordersPage').style.display = 'block';
                    loadOrders();
                    break;
                case 'customers':
                    document.getElementById('customersPage').style.display = 'block';
                    loadCustomers();
                    break;
                case 'analytics':
                    document.getElementById('analyticsPage').style.display = 'block';
                    loadAnalytics();
                    break;
            }
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 90px;
                right: 20px;
                background: ${type === 'info' ? '#667eea' : '#48bb78'};
                color: white;
                padding: 16px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1002;
                font-weight: 500;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (searchTerm.length > 2) {
                // Filter orders table based on search
                const rows = document.querySelectorAll('#ordersTableBody tr');
                let visibleCount = 0;
                
                rows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    if (text.includes(searchTerm)) {
                        row.style.display = '';
                        visibleCount++;
                    } else {
                        row.style.display = 'none';
                    }
                });
                
                if (visibleCount === 0 && searchTerm.length > 0) {
                    showNotification(`No results found for "${searchTerm}"`, 'info');
                }
            } else {
                // Show all rows if search is cleared
                document.querySelectorAll('#ordersTableBody tr').forEach(row => {
                    row.style.display = '';
                });
            }
        }

        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.getElementById('themeText');
            
            body.classList.toggle('dark-theme');
            
            if (body.classList.contains('dark-theme')) {
                themeIcon.textContent = '‚òÄÔ∏è';
                themeText.textContent = 'Light';
                localStorage.setItem('theme', 'dark');
                showNotification('Switched to dark theme', 'info');
            } else {
                themeIcon.textContent = 'üåô';
                themeText.textContent = 'Dark';
                localStorage.setItem('theme', 'light');
                showNotification('Switched to light theme', 'info');
            }
        }

        function handleLogout() {
            // Create confirmation modal instead of using confirm()
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1003;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                padding: 32px;
                border-radius: 16px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
                text-align: center;
                max-width: 400px;
                margin: 20px;
            `;
            
            modalContent.innerHTML = `
                <h3 style="margin: 0 0 16px 0; color: #2d3748; font-size: 20px;">Confirm Logout</h3>
                <p style="margin: 0 0 24px 0; color: #4a5568;">Are you sure you want to logout?</p>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button onclick="confirmLogout()" style="background: #f56565; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">Yes, Logout</button>
                    <button onclick="cancelLogout()" style="background: #e2e8f0; color: #4a5568; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">Cancel</button>
                </div>
            `;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // Store modal reference for cleanup
            window.logoutModal = modal;
        }

        function confirmLogout() {
            document.body.removeChild(window.logoutModal);
            showNotification('Logging out...', 'info');
            
            // Simulate logout process
            setTimeout(() => {
                showNotification('Successfully logged out!', 'success');
            }, 1000);
        }

        function cancelLogout() {
            document.body.removeChild(window.logoutModal);
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.getElementById('themeText');
            
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                themeIcon.textContent = '‚òÄÔ∏è';
                themeText.textContent = 'Light';
            }
        }

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const menuBtn = document.querySelector('.mobile-menu-btn');
            
            if (window.innerWidth <= 768 && 
                !sidebar.contains(event.target) && 
                !menuBtn.contains(event.target) && 
                sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
            }
        });

        // Category Management
        let categories = [
            {
                id: 1,
                name: 'Electronics',
                description: 'Electronic devices and gadgets including phones, computers, and accessories',
                icon: 'üì±',
                status: 'active',
                createdDate: '2024-01-01',
                productIds: [1, 2, 5]
            },
            {
                id: 2,
                name: 'Sports',
                description: 'Sports equipment, fitness gear, and athletic wear',
                icon: '‚öΩ',
                status: 'active',
                createdDate: '2024-01-02',
                productIds: [3, 6]
            },
            {
                id: 3,
                name: 'Home & Garden',
                description: 'Home appliances, furniture, and garden tools',
                icon: 'üè†',
                status: 'active',
                createdDate: '2024-01-03',
                productIds: [4]
            },
            {
                id: 4,
                name: 'Books',
                description: 'Books, magazines, and educational materials',
                icon: 'üìö',
                status: 'active',
                createdDate: '2024-01-04',
                productIds: []
            },
            {
                id: 5,
                name: 'Clothing',
                description: 'Fashion apparel and accessories for all ages',
                icon: 'üëï',
                status: 'inactive',
                createdDate: '2024-01-05',
                productIds: []
            }
        ];

        let currentCategoryEditId = null;
        let categorySortColumn = '';
        let categorySortDirection = 'asc';

        // Product Management
        let products = [
            {
                id: 1,
                name: 'Wireless Headphones',
                category: 'Electronics',
                price: 129.99,
                stock: 45,
                brand: 'TechSound',
                status: 'active',
                description: 'High-quality wireless headphones with noise cancellation',
                image: 'üéß'
            },
            {
                id: 2,
                name: 'Smart Watch',
                category: 'Electronics',
                price: 299.99,
                stock: 23,
                brand: 'SmartTech',
                status: 'active',
                description: 'Advanced smartwatch with health monitoring',
                image: '‚åö'
            },
            {
                id: 3,
                name: 'Running Shoes',
                category: 'Sports',
                price: 89.99,
                stock: 8,
                brand: 'SportMax',
                status: 'active',
                description: 'Comfortable running shoes for all terrains',
                image: 'üëü'
            },
            {
                id: 4,
                name: 'Coffee Maker',
                category: 'Home & Garden',
                price: 159.99,
                stock: 67,
                brand: 'BrewMaster',
                status: 'active',
                description: 'Automatic coffee maker with programmable settings',
                image: '‚òï'
            },
            {
                id: 5,
                name: 'Bluetooth Speaker',
                category: 'Electronics',
                price: 79.99,
                stock: 34,
                brand: 'SoundWave',
                status: 'inactive',
                description: 'Portable Bluetooth speaker with excellent sound quality',
                image: 'üîä'
            },
            {
                id: 6,
                name: 'Yoga Mat',
                category: 'Sports',
                price: 29.99,
                stock: 156,
                brand: 'FlexFit',
                status: 'active',
                description: 'Non-slip yoga mat for comfortable workouts',
                image: 'üßò'
            }
        ];

        let currentEditId = null;
        let sortColumn = '';
        let sortDirection = 'asc';

        function loadProducts() {
            displayProducts(products);
        }

        function displayProducts(productsToShow) {
            const tbody = document.getElementById('productsTableBody');
            tbody.innerHTML = '';

            productsToShow.forEach(product => {
                const stockClass = product.stock < 20 ? 'stock-low' : product.stock < 50 ? 'stock-medium' : 'stock-high';
                const statusBadge = product.status === 'active' ? 
                    '<span class="status-badge status-completed">Active</span>' : 
                    '<span class="status-badge status-pending">Inactive</span>';

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div class="product-image">${product.image}</div>
                            <div>
                                <div style="font-weight: 600;">${product.name}</div>
                                <div style="font-size: 12px; color: #718096;">${product.brand}</div>
                            </div>
                        </div>
                    </td>
                    <td>${product.category}</td>
                    <td><strong>$${product.price.toFixed(2)}</strong></td>
                    <td><span class="stock-badge ${stockClass}">${product.stock}</span></td>
                    <td>${statusBadge}</td>
                    <td>
                        <button class="action-btn edit-btn" onclick="editProduct(${product.id})">Edit</button>
                        <button class="action-btn toggle-btn" onclick="toggleProductStatus(${product.id})">
                            ${product.status === 'active' ? 'Deactivate' : 'Activate'}
                        </button>
                        <button class="action-btn delete-btn" onclick="deleteProduct(${product.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function filterProducts() {
            const searchTerm = document.getElementById('productSearch').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const minPrice = parseFloat(document.getElementById('minPrice').value) || 0;
            const maxPrice = parseFloat(document.getElementById('maxPrice').value) || Infinity;

            const filtered = products.filter(product => {
                const matchesSearch = product.name.toLowerCase().includes(searchTerm) ||
                                    product.brand.toLowerCase().includes(searchTerm) ||
                                    product.description.toLowerCase().includes(searchTerm);
                const matchesCategory = !categoryFilter || product.category === categoryFilter;
                const matchesStatus = !statusFilter || product.status === statusFilter;
                const matchesPrice = product.price >= minPrice && product.price <= maxPrice;

                return matchesSearch && matchesCategory && matchesStatus && matchesPrice;
            });

            displayProducts(filtered);

            if (filtered.length === 0 && (searchTerm || categoryFilter || statusFilter || minPrice > 0 || maxPrice < Infinity)) {
                showNotification('No products match your filters', 'info');
            }
        }

        function sortProducts(column) {
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }

            products.sort((a, b) => {
                let aVal = a[column];
                let bVal = b[column];

                if (typeof aVal === 'string') {
                    aVal = aVal.toLowerCase();
                    bVal = bVal.toLowerCase();
                }

                if (sortDirection === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });

            displayProducts(products);
            updateSortIcons(column);
        }

        function updateSortIcons(activeColumn) {
            document.querySelectorAll('.sort-icon').forEach(icon => {
                icon.textContent = '‚ÜïÔ∏è';
            });

            const activeIcon = document.querySelector(`th[onclick="sortProducts('${activeColumn}')"] .sort-icon`);
            if (activeIcon) {
                activeIcon.textContent = sortDirection === 'asc' ? '‚Üë' : '‚Üì';
            }
        }

        function showAddProduct() {
            currentEditId = null;
            document.getElementById('modalTitle').textContent = 'Add New Product';
            document.getElementById('productForm').reset();
            document.getElementById('imagePreview').innerHTML = '<span>üì∑ Click to upload image</span>';
            document.getElementById('imagePreview').classList.remove('has-image');
            document.getElementById('productModal').style.display = 'flex';
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;

            currentEditId = id;
            document.getElementById('modalTitle').textContent = 'Edit Product';
            document.getElementById('productName').value = product.name;
            document.getElementById('productCategory').value = product.category;
            document.getElementById('productPrice').value = product.price;
            document.getElementById('productStock').value = product.stock;
            document.getElementById('productBrand').value = product.brand;
            document.getElementById('productStatus').value = product.status;
            document.getElementById('productDescription').value = product.description;

            const preview = document.getElementById('imagePreview');
            preview.innerHTML = `<span style="font-size: 40px;">${product.image}</span>`;
            preview.classList.add('has-image');

            document.getElementById('productModal').style.display = 'flex';
        }

        function closeProductModal() {
            document.getElementById('productModal').style.display = 'none';
            currentEditId = null;
        }

        function saveProduct(event) {
            event.preventDefault();

            const formData = {
                name: document.getElementById('productName').value,
                category: document.getElementById('productCategory').value,
                price: parseFloat(document.getElementById('productPrice').value),
                stock: parseInt(document.getElementById('productStock').value),
                brand: document.getElementById('productBrand').value,
                status: document.getElementById('productStatus').value,
                description: document.getElementById('productDescription').value,
                image: document.getElementById('imagePreview').classList.contains('has-image') ? 
                       document.getElementById('imagePreview').innerHTML : 'üì¶'
            };

            if (currentEditId) {
                // Edit existing product
                const index = products.findIndex(p => p.id === currentEditId);
                products[index] = { ...products[index], ...formData };
                showNotification('Product updated successfully!', 'success');
            } else {
                // Add new product
                const newProduct = {
                    id: Math.max(...products.map(p => p.id)) + 1,
                    ...formData
                };
                products.push(newProduct);
                showNotification('Product added successfully!', 'success');
            }

            closeProductModal();
            displayProducts(products);
        }

        function toggleProductStatus(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                product.status = product.status === 'active' ? 'inactive' : 'active';
                displayProducts(products);
                showNotification(`Product ${product.status === 'active' ? 'activated' : 'deactivated'}`, 'success');
            }
        }

        function deleteProduct(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;

            // Create confirmation modal
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1004;
            `;

            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                padding: 32px;
                border-radius: 16px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
                text-align: center;
                max-width: 400px;
                margin: 20px;
            `;

            modalContent.innerHTML = `
                <h3 style="margin: 0 0 16px 0; color: #2d3748; font-size: 20px;">Delete Product</h3>
                <p style="margin: 0 0 24px 0; color: #4a5568;">Are you sure you want to delete "${product.name}"? This action cannot be undone.</p>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button onclick="confirmDeleteProduct(${id})" style="background: #f56565; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">Yes, Delete</button>
                    <button onclick="cancelDeleteProduct()" style="background: #e2e8f0; color: #4a5568; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">Cancel</button>
                </div>
            `;

            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            window.deleteModal = modal;
        }

        function confirmDeleteProduct(id) {
            products = products.filter(p => p.id !== id);
            document.body.removeChild(window.deleteModal);
            displayProducts(products);
            showNotification('Product deleted successfully!', 'success');
        }

        function cancelDeleteProduct() {
            document.body.removeChild(window.deleteModal);
        }

        function previewImage(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('imagePreview');

            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.style.backgroundImage = `url(${e.target.result})`;
                    preview.innerHTML = '';
                    preview.classList.add('has-image');
                };
                reader.readAsDataURL(file);
            }
        }

        // Category Management Functions
        function loadCategories() {
            displayCategories(categories);
        }

        function displayCategories(categoriesToShow) {
            const tbody = document.getElementById('categoriesTableBody');
            tbody.innerHTML = '';

            categoriesToShow.forEach(category => {
                const productCount = category.productIds.length;
                const countClass = productCount === 0 ? 'stock-low' : 
                                 productCount <= 10 ? 'stock-medium' : 'stock-high';
                const statusBadge = category.status === 'active' ? 
                    '<span class="status-badge status-completed">Active</span>' : 
                    '<span class="status-badge status-pending">Inactive</span>';

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div class="product-image">${category.icon}</div>
                            <div>
                                <div style="font-weight: 600;">${category.name}</div>
                            </div>
                        </div>
                    </td>
                    <td style="max-width: 300px;">
                        <div style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${category.description}">
                            ${category.description || 'No description'}
                        </div>
                    </td>
                    <td><span class="stock-badge ${countClass}">${productCount} products</span></td>
                    <td>${statusBadge}</td>
                    <td>${category.createdDate}</td>
                    <td>
                        <button class="action-btn edit-btn" onclick="editCategory(${category.id})">Edit</button>
                        <button class="action-btn toggle-btn" onclick="toggleCategoryStatus(${category.id})">
                            ${category.status === 'active' ? 'Deactivate' : 'Activate'}
                        </button>
                        <button class="action-btn delete-btn" onclick="deleteCategory(${category.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function filterCategories() {
            const searchTerm = document.getElementById('categorySearch').value.toLowerCase();
            const countFilter = document.getElementById('productCountFilter').value;
            const statusFilter = document.getElementById('categoryStatusFilter').value;

            const filtered = categories.filter(category => {
                const matchesSearch = category.name.toLowerCase().includes(searchTerm) ||
                                    category.description.toLowerCase().includes(searchTerm);
                const matchesStatus = !statusFilter || category.status === statusFilter;
                
                let matchesCount = true;
                const productCount = category.productIds.length;
                if (countFilter === 'empty') matchesCount = productCount === 0;
                else if (countFilter === 'low') matchesCount = productCount >= 1 && productCount <= 10;
                else if (countFilter === 'medium') matchesCount = productCount >= 11 && productCount <= 50;
                else if (countFilter === 'high') matchesCount = productCount > 50;

                return matchesSearch && matchesStatus && matchesCount;
            });

            displayCategories(filtered);

            if (filtered.length === 0 && (searchTerm || countFilter || statusFilter)) {
                showNotification('No categories match your filters', 'info');
            }
        }

        function clearCategoryFilters() {
            document.getElementById('categorySearch').value = '';
            document.getElementById('productCountFilter').value = '';
            document.getElementById('categoryStatusFilter').value = '';
            displayCategories(categories);
        }

        function sortCategories(column) {
            if (categorySortColumn === column) {
                categorySortDirection = categorySortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                categorySortColumn = column;
                categorySortDirection = 'asc';
            }

            categories.sort((a, b) => {
                let aVal, bVal;
                
                if (column === 'productCount') {
                    aVal = a.productIds.length;
                    bVal = b.productIds.length;
                } else {
                    aVal = a[column];
                    bVal = b[column];
                    if (typeof aVal === 'string') {
                        aVal = aVal.toLowerCase();
                        bVal = bVal.toLowerCase();
                    }
                }

                if (categorySortDirection === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });

            displayCategories(categories);
            updateCategorySortIcons(column);
        }

        function updateCategorySortIcons(activeColumn) {
            document.querySelectorAll('#categoriesPage .sort-icon').forEach(icon => {
                icon.textContent = '‚ÜïÔ∏è';
            });

            const activeIcon = document.querySelector(`#categoriesPage th[onclick="sortCategories('${activeColumn}')"] .sort-icon`);
            if (activeIcon) {
                activeIcon.textContent = categorySortDirection === 'asc' ? '‚Üë' : '‚Üì';
            }
        }

        function showAddCategory() {
            currentCategoryEditId = null;
            document.getElementById('categoryModalTitle').textContent = 'Add New Category';
            document.getElementById('categoryForm').reset();
            populateProductAssignment();
            document.getElementById('categoryModal').style.display = 'flex';
        }

        function editCategory(id) {
            const category = categories.find(c => c.id === id);
            if (!category) return;

            currentCategoryEditId = id;
            document.getElementById('categoryModalTitle').textContent = 'Edit Category';
            document.getElementById('categoryName').value = category.name;
            document.getElementById('categoryDescription').value = category.description;
            document.getElementById('categoryIcon').value = category.icon;
            document.getElementById('categoryStatus').value = category.status;

            populateProductAssignment(category.productIds);
            document.getElementById('categoryModal').style.display = 'flex';
        }

        function populateProductAssignment(selectedProductIds = []) {
            const container = document.getElementById('productAssignment');
            container.innerHTML = '';

            if (products.length === 0) {
                container.innerHTML = '<p style="color: #718096; text-align: center; margin: 20px 0;">No products available to assign</p>';
                return;
            }

            products.forEach(product => {
                const isChecked = selectedProductIds.includes(product.id);
                const checkbox = document.createElement('div');
                checkbox.style.cssText = 'display: flex; align-items: center; gap: 8px; margin-bottom: 8px; padding: 8px; border-radius: 6px; transition: background 0.2s;';
                checkbox.innerHTML = `
                    <input type="checkbox" id="product_${product.id}" value="${product.id}" ${isChecked ? 'checked' : ''} 
                           style="margin: 0; cursor: pointer;">
                    <label for="product_${product.id}" style="cursor: pointer; flex: 1; display: flex; align-items: center; gap: 8px; margin: 0;">
                        <span style="font-size: 16px;">${product.image}</span>
                        <span style="font-weight: 500;">${product.name}</span>
                        <span style="color: #718096; font-size: 12px;">($${product.price})</span>
                    </label>
                `;
                
                checkbox.addEventListener('mouseenter', () => {
                    checkbox.style.background = '#f7fafc';
                });
                checkbox.addEventListener('mouseleave', () => {
                    checkbox.style.background = 'transparent';
                });
                
                container.appendChild(checkbox);
            });
        }

        function closeCategoryModal() {
            document.getElementById('categoryModal').style.display = 'none';
            currentCategoryEditId = null;
        }

        function saveCategory(event) {
            event.preventDefault();

            const selectedProducts = Array.from(document.querySelectorAll('#productAssignment input[type="checkbox"]:checked'))
                .map(checkbox => parseInt(checkbox.value));

            const formData = {
                name: document.getElementById('categoryName').value,
                description: document.getElementById('categoryDescription').value,
                icon: document.getElementById('categoryIcon').value,
                status: document.getElementById('categoryStatus').value,
                productIds: selectedProducts
            };

            if (currentCategoryEditId) {
                // Edit existing category
                const index = categories.findIndex(c => c.id === currentCategoryEditId);
                categories[index] = { ...categories[index], ...formData };
                
                // Update products to reflect new category assignment
                updateProductCategories(currentCategoryEditId, selectedProducts);
                showNotification('Category updated successfully!', 'success');
            } else {
                // Add new category
                const newCategory = {
                    id: Math.max(...categories.map(c => c.id)) + 1,
                    createdDate: new Date().toISOString().split('T')[0],
                    ...formData
                };
                categories.push(newCategory);
                
                // Update products to reflect new category assignment
                updateProductCategories(newCategory.id, selectedProducts);
                showNotification('Category added successfully!', 'success');
            }

            closeCategoryModal();
            displayCategories(categories);
        }

        function updateProductCategories(categoryId, productIds) {
            const category = categories.find(c => c.id === categoryId);
            if (!category) return;

            // Update products with the new category
            products.forEach(product => {
                if (productIds.includes(product.id)) {
                    product.category = category.name;
                }
            });
        }

        function toggleCategoryStatus(id) {
            const category = categories.find(c => c.id === id);
            if (category) {
                category.status = category.status === 'active' ? 'inactive' : 'active';
                displayCategories(categories);
                showNotification(`Category ${category.status === 'active' ? 'activated' : 'deactivated'}`, 'success');
            }
        }

        function deleteCategory(id) {
            const category = categories.find(c => c.id === id);
            if (!category) return;

            const productCount = category.productIds.length;
            const warningText = productCount > 0 ? 
                `This category contains ${productCount} product(s). Deleting it will unassign these products.` : 
                'This action cannot be undone.';

            // Create confirmation modal
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1004;
            `;

            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                padding: 32px;
                border-radius: 16px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
                text-align: center;
                max-width: 450px;
                margin: 20px;
            `;

            modalContent.innerHTML = `
                <h3 style="margin: 0 0 16px 0; color: #2d3748; font-size: 20px;">Delete Category</h3>
                <p style="margin: 0 0 8px 0; color: #4a5568;">Are you sure you want to delete "${category.name}"?</p>
                <p style="margin: 0 0 24px 0; color: #e53e3e; font-size: 14px;">${warningText}</p>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button onclick="confirmDeleteCategory(${id})" style="background: #f56565; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">Yes, Delete</button>
                    <button onclick="cancelDeleteCategory()" style="background: #e2e8f0; color: #4a5568; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">Cancel</button>
                </div>
            `;

            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            window.deleteCategoryModal = modal;
        }

        function confirmDeleteCategory(id) {
            const category = categories.find(c => c.id === id);
            
            // Remove category assignment from products
            if (category) {
                products.forEach(product => {
                    if (category.productIds.includes(product.id)) {
                        product.category = 'Uncategorized';
                    }
                });
            }
            
            categories = categories.filter(c => c.id !== id);
            document.body.removeChild(window.deleteCategoryModal);
            displayCategories(categories);
            showNotification('Category deleted successfully!', 'success');
        }

        function cancelDeleteCategory() {
            document.body.removeChild(window.deleteCategoryModal);
        }

        // Customer Management
        let customers = [
            {
                id: 1,
                name: 'Sarah Johnson',
                email: 'sarah.j@email.com',
                phone: '+1 (555) 987-6543',
                address: '456 Oak Ave, Los Angeles, CA 90210',
                signupDate: '2023-08-15',
                lastLogin: '2024-01-15',
                totalOrders: 12,
                totalSpent: 2847.50,
                status: 'active',
                avatar: 'üë©',
                preferences: {
                    newsletter: true,
                    sms: false,
                    category: 'Electronics'
                },
                orderHistory: ['ORD-2024-002', 'ORD-2023-156', 'ORD-2023-134']
            },
            {
                id: 2,
                name: 'Michael Chen',
                email: 'm.chen@email.com',
                phone: '+1 (555) 234-5678',
                address: '789 Pine St, San Francisco, CA 94102',
                signupDate: '2023-06-22',
                lastLogin: '2024-01-14',
                totalOrders: 8,
                totalSpent: 1456.80,
                status: 'active',
                avatar: 'üë®',
                preferences: {
                    newsletter: true,
                    sms: true,
                    category: 'Sports'
                },
                orderHistory: ['ORD-2024-001', 'ORD-2023-189']
            },
            {
                id: 3,
                name: 'Emily Rodriguez',
                email: 'emily.r@email.com',
                phone: '+1 (555) 345-6789',
                address: '321 Elm St, Austin, TX 78701',
                signupDate: '2023-09-10',
                lastLogin: '2024-01-13',
                totalOrders: 15,
                totalSpent: 3245.90,
                status: 'active',
                avatar: 'üë©',
                preferences: {
                    newsletter: false,
                    sms: true,
                    category: 'Home & Garden'
                },
                orderHistory: ['ORD-2024-003', 'ORD-2023-201']
            },
            {
                id: 4,
                name: 'David Kim',
                email: 'david.kim@email.com',
                phone: '+1 (555) 456-7890',
                address: '654 Maple Dr, Seattle, WA 98101',
                signupDate: '2023-11-05',
                lastLogin: '2024-01-12',
                totalOrders: 7,
                totalSpent: 1789.20,
                status: 'active',
                avatar: 'üë®',
                preferences: {
                    newsletter: true,
                    sms: false,
                    category: 'Electronics'
                },
                orderHistory: ['ORD-2024-005']
            },
            {
                id: 5,
                name: 'Lisa Thompson',
                email: 'lisa.t@email.com',
                phone: '+1 (555) 567-8901',
                address: '987 Cedar Ln, Miami, FL 33101',
                signupDate: '2023-07-18',
                lastLogin: '2023-12-28',
                totalOrders: 11,
                totalSpent: 2156.75,
                status: 'inactive',
                avatar: 'üë©',
                preferences: {
                    newsletter: true,
                    sms: true,
                    category: 'Clothing'
                },
                orderHistory: ['ORD-2023-298', 'ORD-2023-267']
            },
            {
                id: 6,
                name: 'James Wilson',
                email: 'j.wilson@email.com',
                phone: '+1 (555) 678-9012',
                address: '123 Oak St, Denver, CO 80202',
                signupDate: '2024-01-02',
                lastLogin: '2024-01-11',
                totalOrders: 2,
                totalSpent: 298.50,
                status: 'active',
                avatar: 'üë®',
                preferences: {
                    newsletter: false,
                    sms: false,
                    category: 'Books'
                },
                orderHistory: ['ORD-2024-007']
            },
            {
                id: 7,
                name: 'Anna Martinez',
                email: 'anna.m@email.com',
                phone: '+1 (555) 789-0123',
                address: '456 Birch Ave, Phoenix, AZ 85001',
                signupDate: '2023-05-30',
                lastLogin: '2024-01-10',
                totalOrders: 6,
                totalSpent: 987.40,
                status: 'active',
                avatar: 'üë©',
                preferences: {
                    newsletter: true,
                    sms: true,
                    category: 'Sports'
                },
                orderHistory: ['ORD-2024-008']
            },
            {
                id: 8,
                name: 'Robert Brown',
                email: 'r.brown@email.com',
                phone: '+1 (555) 890-1234',
                address: '789 Spruce St, Boston, MA 02101',
                signupDate: '2023-12-15',
                lastLogin: '2024-01-09',
                totalOrders: 4,
                totalSpent: 654.30,
                status: 'active',
                avatar: 'üë®',
                preferences: {
                    newsletter: false,
                    sms: true,
                    category: 'Electronics'
                },
                orderHistory: ['ORD-2024-004']
            },
            {
                id: 9,
                name: 'Jennifer Davis',
                email: 'jen.davis@email.com',
                phone: '+1 (555) 901-2345',
                address: '321 Willow Dr, Portland, OR 97201',
                signupDate: '2023-04-12',
                lastLogin: '2023-11-20',
                totalOrders: 0,
                totalSpent: 0.00,
                status: 'disabled',
                avatar: 'üë©',
                preferences: {
                    newsletter: false,
                    sms: false,
                    category: 'None'
                },
                orderHistory: []
            },
            {
                id: 10,
                name: 'Christopher Lee',
                email: 'chris.lee@email.com',
                phone: '+1 (555) 012-3456',
                address: '654 Poplar St, Nashville, TN 37201',
                signupDate: '2024-01-08',
                lastLogin: '2024-01-15',
                totalOrders: 1,
                totalSpent: 129.99,
                status: 'active',
                avatar: 'üë®',
                preferences: {
                    newsletter: true,
                    sms: false,
                    category: 'Electronics'
                },
                orderHistory: ['ORD-2024-009']
            }
        ];

        let customerSortColumn = '';
        let customerSortDirection = 'asc';
        let filteredCustomers = [...customers];

        function loadCustomers() {
            filteredCustomers = [...customers];
            displayCustomers(filteredCustomers);
            updateCustomerCount();
            updateCustomerStats();
        }

        function displayCustomers(customersToShow) {
            const tbody = document.getElementById('customersTableBody');
            tbody.innerHTML = '';

            customersToShow.forEach(customer => {
                const statusClass = `status-${customer.status === 'active' ? 'completed' : customer.status === 'inactive' ? 'pending' : 'cancelled'}`;
                const statusText = customer.status.charAt(0).toUpperCase() + customer.status.slice(1);
                const lastLoginDate = new Date(customer.lastLogin);
                const daysSinceLogin = Math.floor((new Date() - lastLoginDate) / (1000 * 60 * 60 * 24));
                const loginStatus = daysSinceLogin <= 7 ? 'Recent' : daysSinceLogin <= 30 ? `${daysSinceLogin}d ago` : 'Inactive';

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div class="product-image">${customer.avatar}</div>
                            <div>
                                <div style="font-weight: 600;">${customer.name}</div>
                                <div style="font-size: 12px; color: #718096;">${customer.phone}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div>
                            <div style="font-weight: 500;">${customer.email}</div>
                            <div style="font-size: 12px; color: #718096;">${customer.preferences.category} enthusiast</div>
                        </div>
                    </td>
                    <td>${customer.signupDate}</td>
                    <td>
                        <div style="font-weight: 600; color: ${customer.totalOrders > 10 ? '#48bb78' : customer.totalOrders > 5 ? '#ed8936' : '#718096'};">
                            ${customer.totalOrders}
                        </div>
                    </td>
                    <td><strong>$${customer.totalSpent.toLocaleString()}</strong></td>
                    <td>
                        <div>
                            <div style="font-size: 12px;">${customer.lastLogin}</div>
                            <div style="font-size: 11px; color: ${daysSinceLogin <= 7 ? '#48bb78' : '#718096'};">${loginStatus}</div>
                        </div>
                    </td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn edit-btn" onclick="viewCustomerDetails(${customer.id})">View</button>
                        <button class="action-btn toggle-btn" onclick="toggleCustomerStatus(${customer.id})">
                            ${customer.status === 'active' ? 'Disable' : customer.status === 'disabled' ? 'Enable' : 'Activate'}
                        </button>
                        ${customer.status !== 'disabled' ? `<button class="action-btn delete-btn" onclick="deleteCustomer(${customer.id})">Delete</button>` : ''}
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function filterCustomers() {
            const searchTerm = document.getElementById('customerSearch').value.toLowerCase();
            const statusFilter = document.getElementById('customerStatusFilter').value;
            const ordersFilter = document.getElementById('customerOrdersFilter').value;
            const dateFrom = document.getElementById('customerDateFrom').value;

            filteredCustomers = customers.filter(customer => {
                const matchesSearch = customer.name.toLowerCase().includes(searchTerm) ||
                                    customer.email.toLowerCase().includes(searchTerm) ||
                                    customer.phone.includes(searchTerm);
                const matchesStatus = !statusFilter || customer.status === statusFilter;
                const matchesDateFrom = !dateFrom || customer.signupDate >= dateFrom;
                
                let matchesOrders = true;
                if (ordersFilter === 'new') matchesOrders = customer.totalOrders === 0;
                else if (ordersFilter === 'low') matchesOrders = customer.totalOrders >= 1 && customer.totalOrders <= 5;
                else if (ordersFilter === 'medium') matchesOrders = customer.totalOrders >= 6 && customer.totalOrders <= 20;
                else if (ordersFilter === 'high') matchesOrders = customer.totalOrders > 20;

                return matchesSearch && matchesStatus && matchesOrders && matchesDateFrom;
            });

            displayCustomers(filteredCustomers);
            updateCustomerCount();
        }

        function clearCustomerFilters() {
            document.getElementById('customerSearch').value = '';
            document.getElementById('customerStatusFilter').value = '';
            document.getElementById('customerOrdersFilter').value = '';
            document.getElementById('customerDateFrom').value = '';
            filteredCustomers = [...customers];
            displayCustomers(filteredCustomers);
            updateCustomerCount();
        }

        function updateCustomerCount() {
            const count = filteredCustomers.length;
            const total = customers.length;
            document.getElementById('customerCount').textContent = 
                count === total ? `Showing ${total} customers` : `Showing ${count} of ${total} customers`;
        }

        function updateCustomerStats() {
            const totalCustomers = customers.length;
            const activeCustomers = customers.filter(c => c.status === 'active').length;
            const newThisMonth = customers.filter(c => {
                const signupDate = new Date(c.signupDate);
                const thisMonth = new Date();
                return signupDate.getMonth() === thisMonth.getMonth() && signupDate.getFullYear() === thisMonth.getFullYear();
            }).length;
            const avgLifetimeValue = customers.reduce((sum, c) => sum + c.totalSpent, 0) / totalCustomers;

            document.getElementById('totalCustomers').textContent = totalCustomers.toLocaleString();
            document.getElementById('activeCustomers').textContent = activeCustomers.toLocaleString();
            document.getElementById('newCustomers').textContent = newThisMonth.toLocaleString();
            document.getElementById('avgLifetimeValue').textContent = '$' + Math.round(avgLifetimeValue);
        }

        function sortCustomers(column) {
            if (customerSortColumn === column) {
                customerSortDirection = customerSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                customerSortColumn = column;
                customerSortDirection = 'asc';
            }

            filteredCustomers.sort((a, b) => {
                let aVal, bVal;

                switch(column) {
                    case 'name':
                        aVal = a.name.toLowerCase();
                        bVal = b.name.toLowerCase();
                        break;
                    case 'email':
                        aVal = a.email.toLowerCase();
                        bVal = b.email.toLowerCase();
                        break;
                    case 'signupDate':
                        aVal = new Date(a.signupDate);
                        bVal = new Date(b.signupDate);
                        break;
                    case 'totalOrders':
                        aVal = a.totalOrders;
                        bVal = b.totalOrders;
                        break;
                    case 'totalSpent':
                        aVal = a.totalSpent;
                        bVal = b.totalSpent;
                        break;
                    case 'lastLogin':
                        aVal = new Date(a.lastLogin);
                        bVal = new Date(b.lastLogin);
                        break;
                    case 'status':
                        aVal = a.status;
                        bVal = b.status;
                        break;
                    default:
                        return 0;
                }

                if (customerSortDirection === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });

            displayCustomers(filteredCustomers);
            updateCustomerSortIcons(column);
        }

        function updateCustomerSortIcons(activeColumn) {
            document.querySelectorAll('#customersPage .sort-icon').forEach(icon => {
                icon.textContent = '‚ÜïÔ∏è';
            });

            const activeIcon = document.querySelector(`#customersPage th[onclick="sortCustomers('${activeColumn}')"] .sort-icon`);
            if (activeIcon) {
                activeIcon.textContent = customerSortDirection === 'asc' ? '‚Üë' : '‚Üì';
            }
        }

        function viewCustomerDetails(customerId) {
            const customer = customers.find(c => c.id === customerId);
            if (!customer) return;

            document.getElementById('customerDetailsTitle').textContent = `${customer.name} - Customer Details`;
            
            const customerOrders = orders.filter(order => 
                order.customer.email === customer.email
            );

            const content = document.getElementById('customerDetailsContent');
            content.innerHTML = `
                <div class="order-details-grid">
                    <div class="detail-section">
                        <h4>üë§ Personal Information</h4>
                        <div class="detail-row">
                            <span class="detail-label">Full Name:</span>
                            <span class="detail-value">${customer.name}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">${customer.email}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value">${customer.phone}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Address:</span>
                            <span class="detail-value">${customer.address}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Status:</span>
                            <span class="detail-value">
                                <span class="status-badge status-${customer.status === 'active' ? 'completed' : customer.status === 'inactive' ? 'pending' : 'cancelled'}">
                                    ${customer.status.charAt(0).toUpperCase() + customer.status.slice(1)}
                                </span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>üìä Account Statistics</h4>
                        <div class="detail-row">
                            <span class="detail-label">Signup Date:</span>
                            <span class="detail-value">${customer.signupDate}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Last Login:</span>
                            <span class="detail-value">${customer.lastLogin}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Orders:</span>
                            <span class="detail-value">${customer.totalOrders}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Spent:</span>
                            <span class="detail-value">$${customer.totalSpent.toLocaleString()}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Avg Order Value:</span>
                            <span class="detail-value">$${customer.totalOrders > 0 ? (customer.totalSpent / customer.totalOrders).toFixed(2) : '0.00'}</span>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h4>‚öôÔ∏è Preferences & Settings</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-top: 12px;">
                        <div class="detail-row" style="flex-direction: column; align-items: flex-start;">
                            <span class="detail-label">Newsletter:</span>
                            <span class="detail-value" style="color: ${customer.preferences.newsletter ? '#48bb78' : '#f56565'};">
                                ${customer.preferences.newsletter ? '‚úÖ Subscribed' : '‚ùå Not Subscribed'}
                            </span>
                        </div>
                        <div class="detail-row" style="flex-direction: column; align-items: flex-start;">
                            <span class="detail-label">SMS Notifications:</span>
                            <span class="detail-value" style="color: ${customer.preferences.sms ? '#48bb78' : '#f56565'};">
                                ${customer.preferences.sms ? '‚úÖ Enabled' : '‚ùå Disabled'}
                            </span>
                        </div>
                        <div class="detail-row" style="flex-direction: column; align-items: flex-start;">
                            <span class="detail-label">Favorite Category:</span>
                            <span class="detail-value">${customer.preferences.category}</span>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h4>üõçÔ∏è Order History (${customerOrders.length} orders)</h4>
                    ${customerOrders.length > 0 ? `
                        <table class="items-table">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Date</th>
                                    <th>Items</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${customerOrders.map(order => `
                                    <tr>
                                        <td><strong>${order.id}</strong></td>
                                        <td>${order.date}</td>
                                        <td>${order.items.length} items</td>
                                        <td><strong>$${order.total.toFixed(2)}</strong></td>
                                        <td><span class="status-badge status-${order.status}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    ` : `
                        <div style="text-align: center; padding: 40px 20px; color: #718096;">
                            <div style="font-size: 48px; margin-bottom: 16px;">üõí</div>
                            <div style="font-size: 16px; font-weight: 500;">No orders yet</div>
                            <div style="font-size: 14px; margin-top: 8px;">This customer hasn't placed any orders.</div>
                        </div>
                    `}
                </div>
                
                <div style="margin-top: 24px; text-align: center; display: flex; gap: 12px; justify-content: center;">
                    <button class="action-btn edit-btn" onclick="sendCustomerEmail(${customer.id})" style="padding: 8px 16px;">Send Email</button>
                    <button class="action-btn toggle-btn" onclick="toggleCustomerStatus(${customer.id})" style="padding: 8px 16px;">
                        ${customer.status === 'active' ? 'Disable Account' : customer.status === 'disabled' ? 'Enable Account' : 'Activate Account'}
                    </button>
                    ${customer.status !== 'disabled' ? `<button class="action-btn delete-btn" onclick="deleteCustomer(${customer.id})" style="padding: 8px 16px;">Delete Account</button>` : ''}
                </div>
            `;

            document.getElementById('customerDetailsModal').style.display = 'flex';
        }

        function closeCustomerDetails() {
            document.getElementById('customerDetailsModal').style.display = 'none';
        }

        function toggleCustomerStatus(customerId) {
            const customer = customers.find(c => c.id === customerId);
            if (customer) {
                if (customer.status === 'active') {
                    customer.status = 'disabled';
                } else if (customer.status === 'disabled') {
                    customer.status = 'active';
                } else if (customer.status === 'inactive') {
                    customer.status = 'active';
                }
                
                displayCustomers(filteredCustomers);
                updateCustomerStats();
                
                const statusText = customer.status === 'active' ? 'activated' : 'disabled';
                showNotification(`Customer account ${statusText}`, 'success');
                
                // Close modal if open
                if (document.getElementById('customerDetailsModal').style.display === 'flex') {
                    closeCustomerDetails();
                }
            }
        }

        function deleteCustomer(customerId) {
            const customer = customers.find(c => c.id === customerId);
            if (!customer) return;

            // Create confirmation modal
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1004;
            `;

            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                padding: 32px;
                border-radius: 16px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
                text-align: center;
                max-width: 450px;
                margin: 20px;
            `;

            modalContent.innerHTML = `
                <h3 style="margin: 0 0 16px 0; color: #2d3748; font-size: 20px;">Delete Customer Account</h3>
                <p style="margin: 0 0 8px 0; color: #4a5568;">Are you sure you want to delete "${customer.name}"?</p>
                <p style="margin: 0 0 24px 0; color: #e53e3e; font-size: 14px;">This will permanently delete their account and order history. This action cannot be undone.</p>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button onclick="confirmDeleteCustomer(${customerId})" style="background: #f56565; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">Yes, Delete</button>
                    <button onclick="cancelDeleteCustomer()" style="background: #e2e8f0; color: #4a5568; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">Cancel</button>
                </div>
            `;

            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            window.deleteCustomerModal = modal;
        }

        function confirmDeleteCustomer(customerId) {
            customers = customers.filter(c => c.id !== customerId);
            filteredCustomers = filteredCustomers.filter(c => c.id !== customerId);
            document.body.removeChild(window.deleteCustomerModal);
            displayCustomers(filteredCustomers);
            updateCustomerCount();
            updateCustomerStats();
            showNotification('Customer account deleted successfully!', 'success');
            
            // Close modal if open
            if (document.getElementById('customerDetailsModal').style.display === 'flex') {
                closeCustomerDetails();
            }
        }

        function cancelDeleteCustomer() {
            document.body.removeChild(window.deleteCustomerModal);
        }

        function sendCustomerEmail(customerId) {
            const customer = customers.find(c => c.id === customerId);
            if (customer) {
                showNotification(`Email sent to ${customer.name} (${customer.email})`, 'success');
            }
        }

        function exportCustomers(format) {
            if (format === 'csv') {
                exportCustomersCSV();
            } else if (format === 'pdf') {
                exportCustomersPDF();
            }
        }

        function exportCustomersCSV() {
            const headers = ['Name', 'Email', 'Phone', 'Signup Date', 'Total Orders', 'Total Spent', 'Last Login', 'Status'];
            const csvContent = [
                headers.join(','),
                ...filteredCustomers.map(customer => [
                    `"${customer.name}"`,
                    customer.email,
                    `"${customer.phone}"`,
                    customer.signupDate,
                    customer.totalOrders,
                    customer.totalSpent.toFixed(2),
                    customer.lastLogin,
                    customer.status
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `customers_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
            
            showNotification('Customer data exported to CSV successfully!', 'success');
        }

        function exportCustomersPDF() {
            const pdfContent = `
                <html>
                <head>
                    <title>Customers Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #2d3748; }
                        .stats { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 20px; margin: 20px 0; }
                        .stat-card { border: 1px solid #e2e8f0; padding: 16px; border-radius: 8px; text-align: center; }
                        .stat-value { font-size: 24px; font-weight: bold; color: #2d3748; }
                        .stat-label { font-size: 14px; color: #718096; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f7fafc; }
                        .status { padding: 4px 8px; border-radius: 4px; font-size: 12px; }
                        .status-active { background: #c6f6d5; color: #22543d; }
                        .status-inactive { background: #fef5e7; color: #c05621; }
                        .status-disabled { background: #fed7d7; color: #c53030; }
                    </style>
                </head>
                <body>
                    <h1>üë• Customer Report - ${new Date().toLocaleDateString()}</h1>
                    
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-value">${customers.length}</div>
                            <div class="stat-label">Total Customers</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">${customers.filter(c => c.status === 'active').length}</div>
                            <div class="stat-label">Active Customers</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">$${Math.round(customers.reduce((sum, c) => sum + c.totalSpent, 0) / customers.length)}</div>
                            <div class="stat-label">Avg Lifetime Value</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">${Math.round(customers.reduce((sum, c) => sum + c.totalOrders, 0) / customers.length)}</div>
                            <div class="stat-label">Avg Orders per Customer</div>
                        </div>
                    </div>
                    
                    <p>Showing ${filteredCustomers.length} customers</p>
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Signup Date</th>
                                <th>Orders</th>
                                <th>Total Spent</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${filteredCustomers.map(customer => `
                                <tr>
                                    <td>${customer.name}</td>
                                    <td>${customer.email}</td>
                                    <td>${customer.signupDate}</td>
                                    <td>${customer.totalOrders}</td>
                                    <td>$${customer.totalSpent.toFixed(2)}</td>
                                    <td><span class="status status-${customer.status}">${customer.status}</span></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </body>
                </html>
            `;

            const printWindow = window.open('', '_blank');
            printWindow.document.write(pdfContent);
            printWindow.document.close();
            printWindow.print();
            
            showNotification('Customer report opened for printing/PDF save!', 'success');
        }

        // Order Management
        let orders = [
            {
                id: 'ORD-2024-001',
                customer: {
                    name: 'John Smith',
                    email: 'john.smith@email.com',
                    phone: '+1 (555) 123-4567',
                    address: '123 Main St, New York, NY 10001'
                },
                items: [
                    { id: 1, name: 'Wireless Headphones', price: 129.99, quantity: 1, image: 'üéß' },
                    { id: 2, name: 'Phone Case', price: 24.99, quantity: 2, image: 'üì±' }
                ],
                subtotal: 179.97,
                tax: 14.40,
                shipping: 9.99,
                total: 204.36,
                status: 'delivered',
                date: '2024-01-15',
                trackingNumber: 'TRK123456789'
            },
            {
                id: 'ORD-2024-002',
                customer: {
                    name: 'Sarah Johnson',
                    email: 'sarah.j@email.com',
                    phone: '+1 (555) 987-6543',
                    address: '456 Oak Ave, Los Angeles, CA 90210'
                },
                items: [
                    { id: 2, name: 'Smart Watch', price: 299.99, quantity: 1, image: '‚åö' }
                ],
                subtotal: 299.99,
                tax: 24.00,
                shipping: 0.00,
                total: 323.99,
                status: 'shipped',
                date: '2024-01-15',
                trackingNumber: 'TRK987654321'
            },
            {
                id: 'ORD-2024-003',
                customer: {
                    name: 'Mike Davis',
                    email: 'mike.davis@email.com',
                    phone: '+1 (555) 456-7890',
                    address: '789 Pine St, Chicago, IL 60601'
                },
                items: [
                    { id: 4, name: 'Coffee Maker', price: 159.99, quantity: 1, image: '‚òï' },
                    { id: 6, name: 'Yoga Mat', price: 29.99, quantity: 1, image: 'üßò' }
                ],
                subtotal: 189.98,
                tax: 15.20,
                shipping: 12.99,
                total: 218.17,
                status: 'processing',
                date: '2024-01-14',
                trackingNumber: null
            },
            {
                id: 'ORD-2024-004',
                customer: {
                    name: 'Emily Brown',
                    email: 'emily.brown@email.com',
                    phone: '+1 (555) 321-0987',
                    address: '321 Elm St, Miami, FL 33101'
                },
                items: [
                    { id: 5, name: 'Bluetooth Speaker', price: 89.99, quantity: 1, image: 'üîä' }
                ],
                subtotal: 89.99,
                tax: 7.20,
                shipping: 5.99,
                total: 103.18,
                status: 'pending',
                date: '2024-01-14',
                trackingNumber: null
            },
            {
                id: 'ORD-2024-005',
                customer: {
                    name: 'David Wilson',
                    email: 'david.w@email.com',
                    phone: '+1 (555) 654-3210',
                    address: '654 Maple Dr, Seattle, WA 98101'
                },
                items: [
                    { id: 3, name: 'Running Shoes', price: 89.99, quantity: 1, image: 'üëü' },
                    { id: 1, name: 'Wireless Headphones', price: 129.99, quantity: 1, image: 'üéß' }
                ],
                subtotal: 219.98,
                tax: 17.60,
                shipping: 0.00,
                total: 237.58,
                status: 'cancelled',
                date: '2024-01-13',
                trackingNumber: null
            },
            {
                id: 'ORD-2024-006',
                customer: {
                    name: 'Lisa Garcia',
                    email: 'lisa.garcia@email.com',
                    phone: '+1 (555) 789-0123',
                    address: '987 Cedar Ln, Austin, TX 78701'
                },
                items: [
                    { id: 2, name: 'Smart Watch', price: 299.99, quantity: 2, image: '‚åö' }
                ],
                subtotal: 599.98,
                tax: 48.00,
                shipping: 0.00,
                total: 647.98,
                status: 'processing',
                date: '2024-01-13',
                trackingNumber: null
            }
        ];

        let orderSortColumn = '';
        let orderSortDirection = 'asc';
        let filteredOrders = [...orders];

        function loadOrders() {
            filteredOrders = [...orders];
            displayOrders(filteredOrders);
            updateOrderCount();
        }

        function displayOrders(ordersToShow) {
            const tbody = document.getElementById('ordersTableBody');
            tbody.innerHTML = '';

            ordersToShow.forEach(order => {
                const statusClass = `status-${order.status}`;
                const itemsPreview = order.items.slice(0, 3).map(item => 
                    `<span class="item-badge">${item.name} (${item.quantity})</span>`
                ).join('');
                const moreItems = order.items.length > 3 ? `<span class="item-badge">+${order.items.length - 3} more</span>` : '';

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${order.id}</strong></td>
                    <td>
                        <div>
                            <div style="font-weight: 600;">${order.customer.name}</div>
                            <div style="font-size: 12px; color: #718096;">${order.customer.email}</div>
                        </div>
                    </td>
                    <td>
                        <div class="order-items-preview">
                            ${itemsPreview}${moreItems}
                        </div>
                    </td>
                    <td><strong>$${order.total.toFixed(2)}</strong></td>
                    <td><span class="status-badge ${statusClass}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span></td>
                    <td>${order.date}</td>
                    <td>
                        <button class="action-btn edit-btn" onclick="viewOrderDetails('${order.id}')">View</button>
                        ${getStatusUpdateButtons(order)}
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function getStatusUpdateButtons(order) {
            const statusFlow = ['pending', 'processing', 'shipped', 'delivered'];
            const currentIndex = statusFlow.indexOf(order.status);
            
            if (order.status === 'cancelled' || order.status === 'delivered') {
                return '';
            }

            const nextStatus = statusFlow[currentIndex + 1];
            if (nextStatus) {
                return `<button class="status-update-btn" onclick="updateOrderStatus('${order.id}', '${nextStatus}')">
                    ${nextStatus.charAt(0).toUpperCase() + nextStatus.slice(1)}
                </button>`;
            }

            return '';
        }

        function updateOrderStatus(orderId, newStatus) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                order.status = newStatus;
                
                // Generate tracking number when shipped
                if (newStatus === 'shipped' && !order.trackingNumber) {
                    order.trackingNumber = 'TRK' + Math.random().toString(36).substr(2, 9).toUpperCase();
                }
                
                displayOrders(filteredOrders);
                showNotification(`Order ${orderId} updated to ${newStatus}`, 'success');
            }
        }

        function filterOrders() {
            const searchTerm = document.getElementById('orderSearch').value.toLowerCase();
            const statusFilter = document.getElementById('orderStatusFilter').value;
            const dateFrom = document.getElementById('orderDateFrom').value;
            const dateTo = document.getElementById('orderDateTo').value;

            filteredOrders = orders.filter(order => {
                const matchesSearch = order.id.toLowerCase().includes(searchTerm) ||
                                    order.customer.name.toLowerCase().includes(searchTerm) ||
                                    order.customer.email.toLowerCase().includes(searchTerm);
                const matchesStatus = !statusFilter || order.status === statusFilter;
                const matchesDateFrom = !dateFrom || order.date >= dateFrom;
                const matchesDateTo = !dateTo || order.date <= dateTo;

                return matchesSearch && matchesStatus && matchesDateFrom && matchesDateTo;
            });

            displayOrders(filteredOrders);
            updateOrderCount();
        }

        function clearOrderFilters() {
            document.getElementById('orderSearch').value = '';
            document.getElementById('orderStatusFilter').value = '';
            document.getElementById('orderDateFrom').value = '';
            document.getElementById('orderDateTo').value = '';
            filteredOrders = [...orders];
            displayOrders(filteredOrders);
            updateOrderCount();
        }

        function updateOrderCount() {
            const count = filteredOrders.length;
            const total = orders.length;
            document.getElementById('orderCount').textContent = 
                count === total ? `Showing ${total} orders` : `Showing ${count} of ${total} orders`;
        }

        function sortOrders(column) {
            if (orderSortColumn === column) {
                orderSortDirection = orderSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                orderSortColumn = column;
                orderSortDirection = 'asc';
            }

            filteredOrders.sort((a, b) => {
                let aVal, bVal;

                switch(column) {
                    case 'id':
                        aVal = a.id;
                        bVal = b.id;
                        break;
                    case 'customer':
                        aVal = a.customer.name.toLowerCase();
                        bVal = b.customer.name.toLowerCase();
                        break;
                    case 'items':
                        aVal = a.items.length;
                        bVal = b.items.length;
                        break;
                    case 'total':
                        aVal = a.total;
                        bVal = b.total;
                        break;
                    case 'status':
                        aVal = a.status;
                        bVal = b.status;
                        break;
                    case 'date':
                        aVal = new Date(a.date);
                        bVal = new Date(b.date);
                        break;
                    default:
                        return 0;
                }

                if (orderSortDirection === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });

            displayOrders(filteredOrders);
            updateOrderSortIcons(column);
        }

        function updateOrderSortIcons(activeColumn) {
            document.querySelectorAll('#ordersPage .sort-icon').forEach(icon => {
                icon.textContent = '‚ÜïÔ∏è';
            });

            const activeIcon = document.querySelector(`#ordersPage th[onclick="sortOrders('${activeColumn}')"] .sort-icon`);
            if (activeIcon) {
                activeIcon.textContent = orderSortDirection === 'asc' ? '‚Üë' : '‚Üì';
            }
        }

        function viewOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            document.getElementById('orderDetailsTitle').textContent = `Order ${order.id}`;
            
            const content = document.getElementById('orderDetailsContent');
            content.innerHTML = `
                <div class="status-timeline">
                    ${generateStatusTimeline(order.status)}
                </div>
                
                <div class="order-details-grid">
                    <div class="detail-section">
                        <h4>üìã Order Information</h4>
                        <div class="detail-row">
                            <span class="detail-label">Order ID:</span>
                            <span class="detail-value">${order.id}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Order Date:</span>
                            <span class="detail-value">${order.date}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Status:</span>
                            <span class="detail-value">
                                <span class="status-badge status-${order.status}">
                                    ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                                </span>
                            </span>
                        </div>
                        ${order.trackingNumber ? `
                        <div class="detail-row">
                            <span class="detail-label">Tracking:</span>
                            <span class="detail-value">${order.trackingNumber}</span>
                        </div>
                        ` : ''}
                    </div>
                    
                    <div class="detail-section">
                        <h4>üë§ Customer Information</h4>
                        <div class="detail-row">
                            <span class="detail-label">Name:</span>
                            <span class="detail-value">${order.customer.name}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">${order.customer.email}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value">${order.customer.phone}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Address:</span>
                            <span class="detail-value">${order.customer.address}</span>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h4>üõçÔ∏è Order Items</h4>
                    <table class="items-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Price</th>
                                <th>Quantity</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${order.items.map(item => `
                                <tr>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="font-size: 20px;">${item.image}</span>
                                            <span>${item.name}</span>
                                        </div>
                                    </td>
                                    <td>$${item.price.toFixed(2)}</td>
                                    <td>${item.quantity}</td>
                                    <td><strong>$${(item.price * item.quantity).toFixed(2)}</strong></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div style="margin-top: 16px; text-align: right;">
                        <div class="detail-row" style="justify-content: flex-end; margin-bottom: 4px;">
                            <span class="detail-label">Subtotal:</span>
                            <span class="detail-value">$${order.subtotal.toFixed(2)}</span>
                        </div>
                        <div class="detail-row" style="justify-content: flex-end; margin-bottom: 4px;">
                            <span class="detail-label">Tax:</span>
                            <span class="detail-value">$${order.tax.toFixed(2)}</span>
                        </div>
                        <div class="detail-row" style="justify-content: flex-end; margin-bottom: 4px;">
                            <span class="detail-label">Shipping:</span>
                            <span class="detail-value">$${order.shipping.toFixed(2)}</span>
                        </div>
                        <div class="detail-row" style="justify-content: flex-end; font-size: 16px; border-top: 1px solid #e2e8f0; padding-top: 8px; margin-top: 8px;">
                            <span class="detail-label">Total:</span>
                            <span class="detail-value" style="font-size: 18px;">$${order.total.toFixed(2)}</span>
                        </div>
                    </div>
                </div>
                
                ${order.status !== 'cancelled' && order.status !== 'delivered' ? `
                <div style="margin-top: 24px; text-align: center;">
                    ${getStatusUpdateButtons(order)}
                    <button class="action-btn delete-btn" onclick="cancelOrder('${order.id}')" style="margin-left: 8px;">Cancel Order</button>
                </div>
                ` : ''}
            `;

            document.getElementById('orderDetailsModal').style.display = 'flex';
        }

        function generateStatusTimeline(currentStatus) {
            const statuses = [
                { key: 'pending', label: 'Pending', icon: '‚è≥' },
                { key: 'processing', label: 'Processing', icon: '‚öôÔ∏è' },
                { key: 'shipped', label: 'Shipped', icon: 'üöö' },
                { key: 'delivered', label: 'Delivered', icon: '‚úÖ' }
            ];

            const currentIndex = statuses.findIndex(s => s.key === currentStatus);
            
            return statuses.map((status, index) => {
                let stepClass = '';
                if (currentStatus === 'cancelled') {
                    stepClass = index === 0 ? 'active' : '';
                } else if (index < currentIndex) {
                    stepClass = 'completed';
                } else if (index === currentIndex) {
                    stepClass = 'active';
                }

                return `
                    <div class="timeline-step ${stepClass}">
                        <div class="timeline-dot">${status.icon}</div>
                        <div class="timeline-label">${status.label}</div>
                    </div>
                `;
            }).join('');
        }

        function closeOrderDetails() {
            document.getElementById('orderDetailsModal').style.display = 'none';
        }

        function cancelOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (order && order.status !== 'delivered' && order.status !== 'cancelled') {
                order.status = 'cancelled';
                closeOrderDetails();
                displayOrders(filteredOrders);
                showNotification(`Order ${orderId} has been cancelled`, 'success');
            }
        }

        function exportOrders(format) {
            if (format === 'csv') {
                exportToCSV();
            } else if (format === 'pdf') {
                exportToPDF();
            }
        }

        function exportToCSV() {
            const headers = ['Order ID', 'Customer', 'Email', 'Items', 'Total', 'Status', 'Date'];
            const csvContent = [
                headers.join(','),
                ...filteredOrders.map(order => [
                    order.id,
                    `"${order.customer.name}"`,
                    order.customer.email,
                    order.items.length,
                    order.total.toFixed(2),
                    order.status,
                    order.date
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `orders_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
            
            showNotification('Orders exported to CSV successfully!', 'success');
        }

        function exportToPDF() {
            // Create a simple PDF-like HTML content
            const pdfContent = `
                <html>
                <head>
                    <title>Orders Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #2d3748; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f7fafc; }
                        .status { padding: 4px 8px; border-radius: 4px; font-size: 12px; }
                        .status-pending { background: #fef5e7; color: #c05621; }
                        .status-processing { background: #bee3f8; color: #2a69ac; }
                        .status-shipped { background: #e6fffa; color: #234e52; }
                        .status-delivered { background: #c6f6d5; color: #22543d; }
                        .status-cancelled { background: #fed7d7; color: #c53030; }
                    </style>
                </head>
                <body>
                    <h1>Orders Report - ${new Date().toLocaleDateString()}</h1>
                    <p>Total Orders: ${filteredOrders.length}</p>
                    <table>
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Items</th>
                                <th>Total</th>
                                <th>Status</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${filteredOrders.map(order => `
                                <tr>
                                    <td>${order.id}</td>
                                    <td>${order.customer.name}</td>
                                    <td>${order.items.length} items</td>
                                    <td>$${order.total.toFixed(2)}</td>
                                    <td><span class="status status-${order.status}">${order.status}</span></td>
                                    <td>${order.date}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </body>
                </html>
            `;

            const printWindow = window.open('', '_blank');
            printWindow.document.write(pdfContent);
            printWindow.document.close();
            printWindow.print();
            
            showNotification('Orders report opened for printing/PDF save!', 'success');
        }

        // Analytics Functions
        function loadAnalytics() {
            initializeAnalyticsCharts();
            populateAnalyticsTables();
            updateAnalyticsKPIs();
        }

        function initializeAnalyticsCharts() {
            // Sales Trends Chart
            const salesCtx = document.getElementById('analyticsSalesChart').getContext('2d');
            const salesData = analyticsData.salesTrends[currentSalesPeriod];
            
            analyticsSalesChart = new Chart(salesCtx, {
                type: 'line',
                data: {
                    labels: salesData.labels,
                    datasets: [{
                        label: 'Sales ($)',
                        data: salesData.sales,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#667eea',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return 'Sales: $' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000) + 'K';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });

            // Customer Types Chart
            const customerCtx = document.getElementById('customerTypesChart').getContext('2d');
            customerTypesChart = new Chart(customerCtx, {
                type: 'doughnut',
                data: {
                    labels: analyticsData.customerTypes.labels,
                    datasets: [{
                        data: analyticsData.customerTypes.data,
                        backgroundColor: analyticsData.customerTypes.colors,
                        borderWidth: 3,
                        borderColor: '#ffffff',
                        hoverBorderWidth: 4,
                        hoverBorderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 12,
                                    weight: '500'
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return label + ': ' + percentage + '%';
                                }
                            }
                        }
                    },
                    animation: {
                        animateRotate: true,
                        duration: 1000
                    }
                }
            });

            // Revenue vs Orders Chart
            const revenueCtx = document.getElementById('revenueOrdersChart').getContext('2d');
            revenueOrdersChart = new Chart(revenueCtx, {
                type: 'line',
                data: {
                    labels: salesData.labels,
                    datasets: [{
                        label: 'Revenue ($)',
                        data: salesData.revenue || salesData.sales,
                        borderColor: '#48bb78',
                        backgroundColor: 'rgba(72, 187, 120, 0.1)',
                        borderWidth: 3,
                        fill: false,
                        tension: 0.4,
                        yAxisID: 'y',
                        pointBackgroundColor: '#48bb78',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }, {
                        label: 'Orders',
                        data: salesData.orders,
                        borderColor: '#ed8936',
                        backgroundColor: 'rgba(237, 137, 54, 0.1)',
                        borderWidth: 3,
                        fill: false,
                        tension: 0.4,
                        yAxisID: 'y1',
                        pointBackgroundColor: '#ed8936',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    if (context.datasetIndex === 0) {
                                        return 'Revenue: $' + context.parsed.y.toLocaleString();
                                    } else {
                                        return 'Orders: ' + context.parsed.y.toLocaleString();
                                    }
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Time Period'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Revenue ($)',
                                color: '#48bb78'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000) + 'K';
                                },
                                color: '#48bb78'
                            },
                            grid: {
                                color: 'rgba(72, 187, 120, 0.1)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Orders',
                                color: '#ed8936'
                            },
                            ticks: {
                                color: '#ed8936'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    }
                }
            });

            // Top Categories Chart
            const categoriesCtx = document.getElementById('topCategoriesChart').getContext('2d');
            topCategoriesChart = new Chart(categoriesCtx, {
                type: 'bar',
                data: {
                    labels: analyticsData.topCategories.labels,
                    datasets: [{
                        label: 'Revenue ($)',
                        data: analyticsData.topCategories.revenue,
                        backgroundColor: analyticsData.topCategories.colors,
                        borderRadius: 8,
                        borderSkipped: false,
                        borderWidth: 2,
                        borderColor: 'rgba(255, 255, 255, 0.8)',
                        hoverBackgroundColor: analyticsData.topCategories.colors.map(color => color + 'CC'),
                        hoverBorderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y;
                                    const total = analyticsData.topCategories.revenue.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return [
                                        'Revenue: $' + value.toLocaleString(),
                                        'Share: ' + percentage + '%',
                                        'Orders: ' + analyticsData.topCategories.orders[context.dataIndex]
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000) + 'K';
                                }
                            },
                            title: {
                                display: true,
                                text: 'Revenue ($)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Categories'
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeOutQuart'
                    }
                }
            });

            // Product Performance Chart
            const performanceCtx = document.getElementById('productPerformanceChart').getContext('2d');
            const topProducts = analyticsData.productPerformance.slice(0, 5);
            
            productPerformanceChart = new Chart(performanceCtx, {
                type: 'bar',
                data: {
                    labels: topProducts.map(p => p.name.length > 15 ? p.name.substring(0, 15) + '...' : p.name),
                    datasets: [{
                        label: 'Units Sold',
                        data: topProducts.map(p => p.unitsSold),
                        backgroundColor: [
                            '#667eea',
                            '#48bb78', 
                            '#ed8936',
                            '#9f7aea',
                            '#4299e1'
                        ],
                        borderRadius: 6,
                        borderSkipped: false,
                        borderWidth: 2,
                        borderColor: 'rgba(255, 255, 255, 0.8)'
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                title: function(context) {
                                    const fullName = topProducts[context[0].dataIndex].name;
                                    return fullName;
                                },
                                label: function(context) {
                                    const product = topProducts[context.dataIndex];
                                    return [
                                        'Units Sold: ' + product.unitsSold.toLocaleString(),
                                        'Revenue: $' + product.revenue.toLocaleString(),
                                        'Category: ' + product.category,
                                        'Market Share: ' + product.percentage + '%'
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            title: {
                                display: true,
                                text: 'Units Sold'
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Products'
                            }
                        }
                    },
                    animation: {
                        duration: 1200,
                        easing: 'easeOutBounce'
                    }
                }
            });

            // Initialize additional analytics charts
            initializeOrderAnalyticsCharts();
            initializeCustomerAnalyticsCharts();
            initializeProductAnalyticsCharts();
        }

        function initializeOrderAnalyticsCharts() {
            // Order Count Over Time Chart
            const orderCountCtx = document.getElementById('orderCountChart').getContext('2d');
            orderCountChart = new Chart(orderCountCtx, {
                type: 'line',
                data: {
                    labels: analyticsData.orderAnalytics.orderCountOverTime.labels,
                    datasets: [{
                        label: 'Orders',
                        data: analyticsData.orderAnalytics.orderCountOverTime.data,
                        borderColor: analyticsData.orderAnalytics.orderCountOverTime.colors,
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#667eea',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return 'Orders: ' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            title: {
                                display: true,
                                text: 'Number of Orders'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Order Status Distribution Chart
            const orderStatusCtx = document.getElementById('orderStatusChart').getContext('2d');
            orderStatusChart = new Chart(orderStatusCtx, {
                type: 'doughnut',
                data: {
                    labels: analyticsData.orderAnalytics.orderStatusDistribution.labels,
                    datasets: [{
                        data: analyticsData.orderAnalytics.orderStatusDistribution.data,
                        backgroundColor: analyticsData.orderAnalytics.orderStatusDistribution.colors,
                        borderWidth: 3,
                        borderColor: '#ffffff',
                        hoverBorderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: {
                                    size: 11
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((context.parsed / total) * 100).toFixed(1);
                                    return context.label + ': ' + context.parsed + ' (' + percentage + '%)';
                                }
                            }
                        }
                    }
                }
            });

            // AOV Trend Chart
            const aovTrendCtx = document.getElementById('aovTrendChart').getContext('2d');
            aovTrendChart = new Chart(aovTrendCtx, {
                type: 'line',
                data: {
                    labels: analyticsData.orderAnalytics.aovTrend.labels,
                    datasets: [{
                        label: 'AOV ($)',
                        data: analyticsData.orderAnalytics.aovTrend.data,
                        borderColor: analyticsData.orderAnalytics.aovTrend.colors,
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#667eea',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return 'AOV: $' + context.parsed.y.toFixed(2);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toFixed(0);
                                }
                            },
                            title: {
                                display: true,
                                text: 'Average Order Value ($)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        function initializeCustomerAnalyticsCharts() {
            // Customer Activity Status Chart
            const customerActivityCtx = document.getElementById('customerActivityChart').getContext('2d');
            customerActivityChart = new Chart(customerActivityCtx, {
                type: 'doughnut',
                data: {
                    labels: analyticsData.customerAnalytics.activityStatus.labels,
                    datasets: [{
                        data: analyticsData.customerAnalytics.activityStatus.data,
                        backgroundColor: analyticsData.customerAnalytics.activityStatus.colors,
                        borderWidth: 3,
                        borderColor: '#ffffff',
                        hoverBorderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: {
                                    size: 11
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((context.parsed / total) * 100).toFixed(1);
                                    return context.label + ': ' + context.parsed.toLocaleString() + ' (' + percentage + '%)';
                                }
                            }
                        }
                    }
                }
            });

            // CLV Distribution Chart
            const clvDistributionCtx = document.getElementById('clvDistributionChart').getContext('2d');
            clvDistributionChart = new Chart(clvDistributionCtx, {
                type: 'bar',
                data: {
                    labels: analyticsData.customerAnalytics.clvDistribution.labels,
                    datasets: [{
                        label: 'Customers',
                        data: analyticsData.customerAnalytics.clvDistribution.data,
                        backgroundColor: analyticsData.customerAnalytics.clvDistribution.colors,
                        borderRadius: 6,
                        borderSkipped: false,
                        borderWidth: 2,
                        borderColor: 'rgba(255, 255, 255, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((context.parsed.y / total) * 100).toFixed(1);
                                    return 'Customers: ' + context.parsed.y.toLocaleString() + ' (' + percentage + '%)';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            title: {
                                display: true,
                                text: 'Number of Customers'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Customer Lifetime Value Range'
                            }
                        }
                    }
                }
            });

            // Populate Top Buyers Table
            const topBuyersTable = document.getElementById('topBuyersTable');
            topBuyersTable.innerHTML = '';
            
            analyticsData.customerAnalytics.topBuyers.forEach(buyer => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="font-weight: 600; font-size: 11px;">${buyer.name}</div>
                        <div style="color: #718096; font-size: 10px;">${buyer.orders} orders</div>
                    </td>
                    <td style="text-align: right; font-weight: 600; color: #48bb78;">$${buyer.totalSpend.toLocaleString()}</td>
                `;
                topBuyersTable.appendChild(row);
            });
        }

        function initializeProductAnalyticsCharts() {
            // Stock-Out Frequency Chart
            const stockOutCtx = document.getElementById('stockOutChart').getContext('2d');
            stockOutChart = new Chart(stockOutCtx, {
                type: 'bar',
                data: {
                    labels: analyticsData.productAnalytics.stockOutFrequency.labels,
                    datasets: [{
                        label: 'Stock-Out Incidents',
                        data: analyticsData.productAnalytics.stockOutFrequency.data,
                        backgroundColor: analyticsData.productAnalytics.stockOutFrequency.colors,
                        borderRadius: 6,
                        borderSkipped: false,
                        borderWidth: 2,
                        borderColor: 'rgba(255, 255, 255, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    return 'Stock-outs: ' + context.parsed.y + ' times';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            title: {
                                display: true,
                                text: 'Number of Stock-Out Incidents'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Conversion Funnel Chart
            const conversionFunnelCtx = document.getElementById('conversionFunnelChart').getContext('2d');
            conversionFunnelChart = new Chart(conversionFunnelCtx, {
                type: 'bar',
                data: {
                    labels: analyticsData.productAnalytics.conversionFunnel.labels,
                    datasets: [{
                        label: 'Count',
                        data: analyticsData.productAnalytics.conversionFunnel.data,
                        backgroundColor: analyticsData.productAnalytics.conversionFunnel.colors,
                        borderRadius: 6,
                        borderSkipped: false,
                        borderWidth: 2,
                        borderColor: 'rgba(255, 255, 255, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const conversionRates = [
                                        '',
                                        '24.9% conversion from views',
                                        '32.4% conversion from cart'
                                    ];
                                    return [
                                        context.label + ': ' + context.parsed.y.toLocaleString(),
                                        conversionRates[context.dataIndex]
                                    ].filter(Boolean);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return (value / 1000) + 'K';
                                }
                            },
                            title: {
                                display: true,
                                text: 'Count'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Profit Margin Chart
            const profitMarginCtx = document.getElementById('profitMarginChart').getContext('2d');
            profitMarginChart = new Chart(profitMarginCtx, {
                type: 'bar',
                data: {
                    labels: analyticsData.productAnalytics.profitMargins.labels,
                    datasets: [{
                        label: 'Profit Margin (%)',
                        data: analyticsData.productAnalytics.profitMargins.data,
                        backgroundColor: analyticsData.productAnalytics.profitMargins.colors,
                        borderRadius: 6,
                        borderSkipped: false,
                        borderWidth: 2,
                        borderColor: 'rgba(255, 255, 255, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#667eea',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const cost = analyticsData.productAnalytics.profitMargins.costs[context.dataIndex];
                                    return [
                                        'Profit Margin: ' + context.parsed.y.toFixed(1) + '%',
                                        'Cost Price: $' + cost.toFixed(2)
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            },
                            title: {
                                display: true,
                                text: 'Profit Margin (%)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Populate Top Selling Products Table
            const topSellingTable = document.getElementById('topSellingTable');
            topSellingTable.innerHTML = '';
            
            analyticsData.productAnalytics.topSellingProducts.forEach(product => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="font-weight: 600; font-size: 11px;">${product.name}</div>
                        <div style="color: #718096; font-size: 10px;">${product.conversions}% conversion</div>
                    </td>
                    <td style="text-align: right; font-weight: 600;">${product.units}</td>
                    <td style="text-align: right; font-weight: 600; color: #48bb78;">$${product.revenue.toLocaleString()}</td>
                `;
                topSellingTable.appendChild(row);
            });
        }

        function populateAnalyticsTables() {
            // Top Products Table
            const topProductsTable = document.getElementById('topProductsTable');
            topProductsTable.innerHTML = '';
            
            analyticsData.productPerformance.forEach(product => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="font-weight: 600;">${product.name}</td>
                    <td>${product.unitsSold}</td>
                    <td><strong>$${product.revenue.toLocaleString()}</strong></td>
                    <td>${product.percentage}%</td>
                `;
                topProductsTable.appendChild(row);
            });

            // Regional Performance Table
            const regionalTable = document.getElementById('regionalTable');
            regionalTable.innerHTML = '';
            
            analyticsData.regionalData.forEach(region => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="font-weight: 600;">${region.region}</td>
                    <td>${region.orders}</td>
                    <td><strong>$${region.revenue.toLocaleString()}</strong></td>
                    <td>$${region.aov.toFixed(2)}</td>
                `;
                regionalTable.appendChild(row);
            });
        }

        function updateAnalyticsKPIs() {
            // Update KPI values based on current filters
            const dateRange = document.getElementById('analyticsDateRange').value;
            
            let kpiData = {
                aov: '$164.25',
                clv: '$892.50',
                conversion: '3.24%',
                returnRate: '42.8%'
            };

            // Adjust values based on date range
            switch(dateRange) {
                case '7days':
                    kpiData = {
                        aov: '$142.80',
                        clv: '$756.20',
                        conversion: '2.98%',
                        returnRate: '38.4%'
                    };
                    break;
                case '90days':
                    kpiData = {
                        aov: '$178.90',
                        clv: '$1,024.30',
                        conversion: '3.67%',
                        returnRate: '46.2%'
                    };
                    break;
                case '1year':
                    kpiData = {
                        aov: '$195.40',
                        clv: '$1,284.70',
                        conversion: '4.12%',
                        returnRate: '52.1%'
                    };
                    break;
            }

            document.getElementById('avgOrderValue').textContent = kpiData.aov;
            document.getElementById('customerLTV').textContent = kpiData.clv;
            document.getElementById('conversionRate').textContent = kpiData.conversion;
            document.getElementById('returnRate').textContent = kpiData.returnRate;
        }

        function setSalesPeriod(period) {
            currentSalesPeriod = period;
            
            // Update button states
            document.querySelectorAll('.chart-period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update chart data
            const salesData = analyticsData.salesTrends[period];
            
            // Update Sales Trends Chart
            analyticsSalesChart.data.labels = salesData.labels;
            analyticsSalesChart.data.datasets[0].data = salesData.sales;
            analyticsSalesChart.update('active');
            
            // Update Revenue vs Orders Chart
            revenueOrdersChart.data.labels = salesData.labels;
            revenueOrdersChart.data.datasets[0].data = salesData.revenue || salesData.sales;
            revenueOrdersChart.data.datasets[1].data = salesData.orders;
            revenueOrdersChart.update('active');
            
            // Show notification about period change
            const periodNames = {
                'day': 'Daily',
                'week': 'Weekly', 
                'month': 'Monthly'
            };
            showNotification(`Switched to ${periodNames[period]} view`, 'info');
        }

        function updateAnalytics() {
            const dateRange = document.getElementById('analyticsDateRange').value;
            const categoryFilter = document.getElementById('analyticsCategoryFilter').value;
            const regionFilter = document.getElementById('analyticsRegionFilter').value;
            
            // Show/hide custom date range
            const customDateRange = document.getElementById('customDateRange');
            if (dateRange === 'custom') {
                customDateRange.style.display = 'flex';
            } else {
                customDateRange.style.display = 'none';
            }
            
            updateAnalyticsKPIs();
            
            // Apply filters to charts and tables
            if (categoryFilter || regionFilter) {
                showNotification(`Filters applied: ${categoryFilter || 'All Categories'}, ${regionFilter || 'All Regions'}`, 'info');
            }
        }

        function resetAnalyticsFilters() {
            document.getElementById('analyticsDateRange').value = '30days';
            document.getElementById('analyticsCategoryFilter').value = '';
            document.getElementById('analyticsRegionFilter').value = '';
            document.getElementById('customDateRange').style.display = 'none';
            updateAnalytics();
            showNotification('Analytics filters reset', 'info');
        }

        function exportAnalytics(format) {
            if (format === 'csv') {
                exportAnalyticsCSV();
            } else if (format === 'pdf') {
                exportAnalyticsPDF();
            }
        }

        function exportAnalyticsCSV() {
            const headers = ['Metric', 'Value', 'Period'];
            const csvContent = [
                headers.join(','),
                `"Average Order Value","${document.getElementById('avgOrderValue').textContent}","${document.getElementById('analyticsDateRange').value}"`,
                `"Customer Lifetime Value","${document.getElementById('customerLTV').textContent}","${document.getElementById('analyticsDateRange').value}"`,
                `"Conversion Rate","${document.getElementById('conversionRate').textContent}","${document.getElementById('analyticsDateRange').value}"`,
                `"Return Customer Rate","${document.getElementById('returnRate').textContent}","${document.getElementById('analyticsDateRange').value}"`,
                '',
                'Product Performance',
                'Product,Units Sold,Revenue,Percentage',
                ...analyticsData.productPerformance.map(p => 
                    `"${p.name}",${p.unitsSold},"$${p.revenue.toFixed(2)}",${p.percentage}%`
                )
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analytics_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
            
            showNotification('Analytics data exported to CSV!', 'success');
        }

        function exportAnalyticsPDF() {
            const pdfContent = `
                <html>
                <head>
                    <title>Analytics Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #2d3748; }
                        .kpi-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
                        .kpi-card { border: 1px solid #e2e8f0; padding: 16px; border-radius: 8px; }
                        .kpi-title { font-size: 14px; color: #718096; margin-bottom: 8px; }
                        .kpi-value { font-size: 24px; font-weight: bold; color: #2d3748; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f7fafc; }
                    </style>
                </head>
                <body>
                    <h1>üìà Analytics Report - ${new Date().toLocaleDateString()}</h1>
                    
                    <div class="kpi-grid">
                        <div class="kpi-card">
                            <div class="kpi-title">Average Order Value</div>
                            <div class="kpi-value">${document.getElementById('avgOrderValue').textContent}</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-title">Customer Lifetime Value</div>
                            <div class="kpi-value">${document.getElementById('customerLTV').textContent}</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-title">Conversion Rate</div>
                            <div class="kpi-value">${document.getElementById('conversionRate').textContent}</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-title">Return Customer Rate</div>
                            <div class="kpi-value">${document.getElementById('returnRate').textContent}</div>
                        </div>
                    </div>
                    
                    <h2>Top Products by Revenue</h2>
                    <table>
                        <thead>
                            <tr><th>Product</th><th>Units Sold</th><th>Revenue</th><th>% of Total</th></tr>
                        </thead>
                        <tbody>
                            ${analyticsData.productPerformance.map(p => `
                                <tr>
                                    <td>${p.name}</td>
                                    <td>${p.unitsSold}</td>
                                    <td>$${p.revenue.toLocaleString()}</td>
                                    <td>${p.percentage}%</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <h2>Regional Performance</h2>
                    <table>
                        <thead>
                            <tr><th>Region</th><th>Orders</th><th>Revenue</th><th>AOV</th></tr>
                        </thead>
                        <tbody>
                            ${analyticsData.regionalData.map(r => `
                                <tr>
                                    <td>${r.region}</td>
                                    <td>${r.orders}</td>
                                    <td>$${r.revenue.toLocaleString()}</td>
                                    <td>$${r.aov.toFixed(2)}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </body>
                </html>
            `;

            const printWindow = window.open('', '_blank');
            printWindow.document.write(pdfContent);
            printWindow.document.close();
            printWindow.print();
            
            showNotification('Analytics report opened for printing/PDF save!', 'success');
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            initializeCharts();
            populateOrdersTable();
            populateNotifications();
            updateDashboard();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9922d126007dbc46',t:'MTc2MTA3MTMzMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
